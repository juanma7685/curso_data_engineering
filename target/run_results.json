{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-12-20T13:10:21.989054Z", "invocation_id": "100da5ff-116a-46e1-a405-76547a7cef1c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:11.497367Z", "completed_at": "2024-12-20T13:10:12.028771Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.031398Z", "completed_at": "2024-12-20T13:10:12.031445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6533267498016357, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.fecha", "compiled": true, "compiled_code": "WITH my_cte AS (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 2557\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        CAST('2019-01-01 00:00:00' AS DATE)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= CAST('2026-01-01 00:00:00' AS DATE)\n\n)\n\nselect * from filtered\n\n\n),\nunioned_dates AS (\n    SELECT \n        date_day,\n        EXTRACT(YEAR FROM date_day) AS year,\n        EXTRACT(MONTH FROM date_day) AS month,\n        EXTRACT(DAY FROM date_day) AS day,\n        EXTRACT(WEEK FROM date_day) AS week,\n        EXTRACT(DOW FROM date_day) AS day_of_week, -- D\u00eda de la semana (0=Lunes, 6=Domingo)\n        EXTRACT(DOY FROM date_day) AS day_of_year, -- D\u00eda del a\u00f1o (1-365 o 1-366 en a\u00f1os bisiestos)\n        EXTRACT(QUARTER FROM date_day) AS quarter,\n        CASE \n            WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN 'Weekend'\n            ELSE 'Weekday'\n        END AS day_type,\n        CASE \n            WHEN EXTRACT(DOW FROM date_day) = 0 THEN 'Monday'\n            WHEN EXTRACT(DOW FROM date_day) = 1 THEN 'Tuesday'\n            WHEN EXTRACT(DOW FROM date_day) = 2 THEN 'Wednesday'\n            WHEN EXTRACT(DOW FROM date_day) = 3 THEN 'Thursday'\n            WHEN EXTRACT(DOW FROM date_day) = 4 THEN 'Friday'\n            WHEN EXTRACT(DOW FROM date_day) = 5 THEN 'Saturday'\n            WHEN EXTRACT(DOW FROM date_day) = 6 THEN 'Sunday'\n        END AS day_name -- Nombre del d\u00eda de la semana\n    FROM my_cte\n\n    UNION ALL\n\n    SELECT \n        CAST('1970-01-01' AS DATE) AS date_day, -- Fecha sin hora\n        1970 AS year, -- A\u00f1o por defecto\n        1 AS month, -- Mes por defecto\n        1 AS day, -- D\u00eda por defecto\n        1 AS week, -- Primera semana del a\u00f1o\n        4 AS day_of_week, -- D\u00eda de la semana (1=Jueves para 1970-01-01)\n        1 AS day_of_year, -- Primer d\u00eda del a\u00f1o\n        1 AS quarter, -- Primer trimestre del a\u00f1o\n        'Unknown' AS day_type, -- Tipo de d\u00eda predeterminado\n        'Thursday' AS day_name -- Nombre del d\u00eda para la fecha 1970-01-01\n)\n\nSELECT *\nFROM unioned_dates", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.153792Z", "completed_at": "2024-12-20T13:10:12.219720Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.222580Z", "completed_at": "2024-12-20T13:10:12.222612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0751492977142334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__budget", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.budget\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(quantity as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as budget_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        quantity::int as quantity,\n        Month(month) as mes,\n        Year(month) as anyo,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\ndeduplicated as (\n    select *,\n        row_number() over (partition by budget_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.235150Z", "completed_at": "2024-12-20T13:10:12.268439Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.271649Z", "completed_at": "2024-12-20T13:10:12.271682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.042439937591552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__returns", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.returns\n    ),\n\n    renamed as (\n\n        select\n            return_id,\n            order_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            CAST(return_date as date) as return_date,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.282904Z", "completed_at": "2024-12-20T13:10:12.311282Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.314076Z", "completed_at": "2024-12-20T13:10:12.314108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03641390800476074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__reviews", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.reviews\n    ),\n\n    renamed as (\n\n        select\n            review_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n            rating::int as rating,\n            comments,\n            CAST(created_at AS DATE) as created_at,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.325273Z", "completed_at": "2024-12-20T13:10:12.353124Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.355614Z", "completed_at": "2024-12-20T13:10:12.355646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035407304763793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__addresses", "compiled": true, "compiled_code": "\n\nwith \n\n-- 1. Fuente de datos\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.addresses\n),\n\n-- 2. Datos renombrados\nrenamed as (\n    select\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        zipcode,\n        country,\n        address,\n        split_part(address, ' ', 1) as address_number,\n        regexp_substr(address, ' (.*)', 1, 1, 'e', 1) as street,\n        state,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\n-- 3. Direcci\u00f3n predeterminada\nno_addresses as (\n    select distinct\n        md5(cast(coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        null as zipcode,\n        'no address' as country,\n        'no address' as address,\n        null as address_number,\n        null as street,\n        null as state,\n        '0' as llegada_id\n),\n\n-- 4. Deduplicaci\u00f3n y manejo de conflictos\ndeduplicated as (\n    select *, \n           row_number() over (partition by address_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_addresses\n    )\n)\n\n-- 5. Selecci\u00f3n final\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.366297Z", "completed_at": "2024-12-20T13:10:12.391155Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.394172Z", "completed_at": "2024-12-20T13:10:12.394210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03292059898376465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__category", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * \n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products\n),\n\nrenamed as (\n    select DISTINCT\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        category,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by category_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.404946Z", "completed_at": "2024-12-20T13:10:12.433846Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.436829Z", "completed_at": "2024-12-20T13:10:12.436859Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037297964096069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__event_type", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.events\n),\n\nrenamed as (\n    select\n        event_type,\n        md5(cast(coalesce(cast(event_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_type_id,\n        _DLT_LOAD_ID as llegada_id\n    from source\n    group by event_type, _DLT_LOAD_ID\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by event_type_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.447815Z", "completed_at": "2024-12-20T13:10:12.574057Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.576985Z", "completed_at": "2024-12-20T13:10:12.577024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13457846641540527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__events", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.events\n\n),\n\nrenamed as (\n\n    select\n        event_id,\n        page_url,\n        -- Extraer el dominio de la URL\n        regexp_substr(page_url, '^(https?://[^/]+)') as domain,\n        -- Extraer el ID \u00fanico de la URL\n        regexp_substr(page_url, '[^/]+$', 1, 1) as page_id,\n        md5(cast(coalesce(cast(event_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_type_id,\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,   \n        session_id,\n        CAST(created_at AS DATE) as created_at,\n        _DLT_LOAD_ID as llegada_id\n\n    from source\n\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.590426Z", "completed_at": "2024-12-20T13:10:12.623880Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.627037Z", "completed_at": "2024-12-20T13:10:12.627070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04294586181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__order_items", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.order_items\n\n),\n\nrenamed as (\n\n    select\n        md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_items_id,\n        order_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        quantity,\n        _DLT_LOAD_ID as llegada_id\n\n    from source\n\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.639135Z", "completed_at": "2024-12-20T13:10:12.677884Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.681191Z", "completed_at": "2024-12-20T13:10:12.681223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04793953895568848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        order_id,\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        shipping_cost,\n        CAST(created_at AS DATE) as created_at,\n        CAST(estimated_delivery_at AS DATE) as estimated_delivery_at,\n        order_cost,\n        order_total,\n        CAST(delivered_at AS DATE) as delivered_at,\n        tracking_id,\n        md5(cast(coalesce(cast(shipping_service as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as shipping_service_id,\n        md5(cast(coalesce(cast(promo_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        md5(cast(coalesce(cast(status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as status_id,\n        _DLT_LOAD_ID as llegada_id\n    from source \n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.694408Z", "completed_at": "2024-12-20T13:10:12.732528Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.735135Z", "completed_at": "2024-12-20T13:10:12.735174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04753303527832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        price::decimal(10, 2) as precio,\n        name as nombre_producto,\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        inventory,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\nno_products as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        0 as precio,\n        'no products' as nombre_producto,\n        md5(cast(coalesce(cast('no products' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        0 as inventory,\n        '0' as llegada_id\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by product_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_products\n    )\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.748039Z", "completed_at": "2024-12-20T13:10:12.780511Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.782996Z", "completed_at": "2024-12-20T13:10:12.783029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.041426658630371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__promos", "compiled": true, "compiled_code": "\n\nwith \n\n-- 1. Fuente de datos\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.promos\n),\n\n-- 2. Datos renombrados\nrenamed as (\n    select\n        md5(cast(coalesce(cast(promo_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        promo_id as name,\n        discount as EUR_discount,\n        status,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\n-- 3. Promos predeterminadas\nno_promos as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        'no promo' as name,\n        null as EUR_discount,\n        null as status,\n        '0' as llegada_id\n),\n\n-- 4. Deduplicaci\u00f3n y manejo de conflictos\ndeduplicated as (\n    select *, \n           row_number() over (partition by promo_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_promos\n    )\n)\n\n-- 5. Selecci\u00f3n final\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.795573Z", "completed_at": "2024-12-20T13:10:12.826881Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.829876Z", "completed_at": "2024-12-20T13:10:12.829909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04044961929321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__shipping_service", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(shipping_service as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as shipping_service_id,\n        shipping_service,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by shipping_service_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.841607Z", "completed_at": "2024-12-20T13:10:12.875360Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.878729Z", "completed_at": "2024-12-20T13:10:12.878764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04282569885253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__status", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as status_id,\n        status,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by status_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.890316Z", "completed_at": "2024-12-20T13:10:12.925648Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.928807Z", "completed_at": "2024-12-20T13:10:12.928847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044213294982910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.users\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        CAST(updated_at AS DATE) as updated_at,\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        last_name,\n        CAST(created_at AS DATE) as created_at,\n        phone_number,\n        first_name,\n        email,\n        _DLT_LOAD_ID as llegada_id\n    from source\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.941506Z", "completed_at": "2024-12-20T13:10:12.945655Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.948489Z", "completed_at": "2024-12-20T13:10:12.948520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013114690780639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.Proyecto_final.personas", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.961922Z", "completed_at": "2024-12-20T13:10:12.971330Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:12.974710Z", "completed_at": "2024-12-20T13:10:12.974755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020470857620239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Proyecto_final.products_snapshot", "compiled": true, "compiled_code": "\n\n\n\nWITH deduplicated_products AS (\n    SELECT \n        *,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS product_id,\n        ROW_NUMBER() OVER (PARTITION BY md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) ORDER BY _DLT_LOAD_ID DESC) AS row_num\n    FROM ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products p\n)\nSELECT *\nFROM deduplicated_products\nWHERE row_num = 1\n", "relation_name": "ALUMNO11_PRO_GOLD_DB.snapshots.products_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:12.988520Z", "completed_at": "2024-12-20T13:10:12.998065Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.000517Z", "completed_at": "2024-12-20T13:10:13.000548Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017975330352783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Proyecto_final.reviews_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect *\nfrom ALUMNO11_PRO_BRONZE_DB.google_sheets.reviews r\n", "relation_name": "ALUMNO11_PRO_GOLD_DB.snapshots.reviews_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.011167Z", "completed_at": "2024-12-20T13:10:13.040395Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.043710Z", "completed_at": "2024-12-20T13:10:13.043757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037947654724121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_fecha", "compiled": true, "compiled_code": "with \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha\n),\n\nrenamed as (\n    select\n        date_day,\n        year,\n        month,\n        day,\n        week,\n        day_of_week,\n        day_of_year,\n        quarter,\n        day_type,\n        day_name\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.063248Z", "completed_at": "2024-12-20T13:10:13.093286Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.096868Z", "completed_at": "2024-12-20T13:10:13.096909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0443265438079834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_fecha", "compiled": true, "compiled_code": "with \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha\n),\n\nrenamed as (\n    select\n        date_day,\n        year,\n        month,\n        day,\n        week,\n        day_of_week,\n        day_of_year,\n        quarter,\n        day_type,\n        day_name\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.111204Z", "completed_at": "2024-12-20T13:10:13.149434Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.152561Z", "completed_at": "2024-12-20T13:10:13.152604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04818296432495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_budget", "compiled": true, "compiled_code": "\n\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_budget)\n    \n),\n\nrenamed as (\n    select\n        budget_id,\n        product_id,\n        quantity,\n        mes,\n        anyo,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.166775Z", "completed_at": "2024-12-20T13:10:13.202901Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.207200Z", "completed_at": "2024-12-20T13:10:13.207243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04778122901916504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_budget", "compiled": true, "compiled_code": "\n\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_budget)\n    \n),\n\nrenamed as (\n    select\n        budget_id,\n        product_id,\n        quantity,\n        mes,\n        anyo,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.220387Z", "completed_at": "2024-12-20T13:10:13.290298Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.293430Z", "completed_at": "2024-12-20T13:10:13.293464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07933545112609863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_anyo__2020.5dd1c26236", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and anyo >= 2020\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.304733Z", "completed_at": "2024-12-20T13:10:13.339320Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.342800Z", "completed_at": "2024-12-20T13:10:13.342846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04429984092712402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_mes__12__1.f1d664fde9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mes >= 1 and mes <= 12\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.359346Z", "completed_at": "2024-12-20T13:10:13.394076Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.396749Z", "completed_at": "2024-12-20T13:10:13.396793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04558157920837402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_quantity__0.fc16210298", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and quantity >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.408005Z", "completed_at": "2024-12-20T13:10:13.466127Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.469264Z", "completed_at": "2024-12-20T13:10:13.469311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06646418571472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_budget_id.006b549f1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect budget_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere budget_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.482299Z", "completed_at": "2024-12-20T13:10:13.513533Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.516976Z", "completed_at": "2024-12-20T13:10:13.517017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04114484786987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_llegada_id.bfcc3f4f74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.536388Z", "completed_at": "2024-12-20T13:10:13.583612Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.590126Z", "completed_at": "2024-12-20T13:10:13.590172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06500887870788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_product_id.28900fc726", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.769552Z", "completed_at": "2024-12-20T13:10:13.831776Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.842023Z", "completed_at": "2024-12-20T13:10:13.842072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0839698314666748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_quantity.f478215981", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.874779Z", "completed_at": "2024-12-20T13:10:13.938975Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:13.942326Z", "completed_at": "2024-12-20T13:10:13.942370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0793752670288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__budget_budget_id.e286deef8f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    budget_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere budget_id is not null\ngroup by budget_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:13.960456Z", "completed_at": "2024-12-20T13:10:13.997420Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.000992Z", "completed_at": "2024-12-20T13:10:14.001036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051259756088256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_returns", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns)\n    \n),\n\nrenamed as (\n    select\n        return_id,\n        order_id,\n        user_id,\n        return_date,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.019607Z", "completed_at": "2024-12-20T13:10:14.053377Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.057514Z", "completed_at": "2024-12-20T13:10:14.057557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04915666580200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_returns", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns)\n    \n),\n\nrenamed as (\n    select\n        return_id,\n        order_id,\n        user_id,\n        return_date,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.068441Z", "completed_at": "2024-12-20T13:10:14.091883Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.094058Z", "completed_at": "2024-12-20T13:10:14.094090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03019094467163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_llegada_id.d9f1b870aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.103513Z", "completed_at": "2024-12-20T13:10:14.131289Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.133390Z", "completed_at": "2024-12-20T13:10:14.133420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034514665603637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_order_id.e9c5a88a22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.144113Z", "completed_at": "2024-12-20T13:10:14.170187Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.172521Z", "completed_at": "2024-12-20T13:10:14.172555Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03336358070373535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_return_id.6f354a4368", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere return_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.183510Z", "completed_at": "2024-12-20T13:10:14.209232Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.211644Z", "completed_at": "2024-12-20T13:10:14.211677Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033681392669677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_user_id.3eaae3618f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.224036Z", "completed_at": "2024-12-20T13:10:14.247023Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.249694Z", "completed_at": "2024-12-20T13:10:14.249727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03203940391540527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__returns_return_id.771f63cf6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    return_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere return_id is not null\ngroup by return_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.260262Z", "completed_at": "2024-12-20T13:10:14.288119Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.290624Z", "completed_at": "2024-12-20T13:10:14.290653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03561067581176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_reviews", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.300712Z", "completed_at": "2024-12-20T13:10:14.324486Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.327404Z", "completed_at": "2024-12-20T13:10:14.327442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03182721138000488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_reviews", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.339638Z", "completed_at": "2024-12-20T13:10:14.373068Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.376064Z", "completed_at": "2024-12-20T13:10:14.376096Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0415802001953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_google_sheets__reviews_comments__1000__0.2020d01378", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        comments\n    ) >= 0 and length(\n        comments\n    ) <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.386487Z", "completed_at": "2024-12-20T13:10:14.413347Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:14.416335Z", "completed_at": "2024-12-20T13:10:14.416368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035124778747558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__reviews_rating__5__1.ca1b68bf35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rating >= 1 and rating <= 5\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:14.427782Z", "completed_at": "2024-12-20T13:10:15.047933Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.051302Z", "completed_at": "2024-12-20T13:10:15.051338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7558610439300537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_of_type_stg_google_sheets__reviews_created_at__date.002c48ad3e", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('REVIEW_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('USER_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('PRODUCT_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('RATING' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('COMMENTS' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('CREATED_AT' as TEXT) as relation_column,\n            cast('DATE' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('LLEGADA_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'CREATED_AT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.190883Z", "completed_at": "2024-12-20T13:10:15.225648Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.228862Z", "completed_at": "2024-12-20T13:10:15.228895Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044075965881347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_llegada_id.a4171fb8d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.240695Z", "completed_at": "2024-12-20T13:10:15.271793Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.274729Z", "completed_at": "2024-12-20T13:10:15.274772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03999471664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_product_id.90cbd73bfe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.286138Z", "completed_at": "2024-12-20T13:10:15.318075Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.320928Z", "completed_at": "2024-12-20T13:10:15.320961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040436506271362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_rating.e7c187076c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.332038Z", "completed_at": "2024-12-20T13:10:15.357584Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.360336Z", "completed_at": "2024-12-20T13:10:15.360383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03400468826293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_review_id.e0ebed4e17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere review_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.371753Z", "completed_at": "2024-12-20T13:10:15.397687Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.400056Z", "completed_at": "2024-12-20T13:10:15.400091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03410744667053223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_user_id.848490bd4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.410653Z", "completed_at": "2024-12-20T13:10:15.446774Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.449315Z", "completed_at": "2024-12-20T13:10:15.449356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04405665397644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__reviews_review_id.60a9384c9d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere review_id is not null\ngroup by review_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.461189Z", "completed_at": "2024-12-20T13:10:15.492819Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.495724Z", "completed_at": "2024-12-20T13:10:15.495759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04048633575439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_addresses", "compiled": true, "compiled_code": "\n\nwith \nsource as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_addresses) -- Solo datos nuevos o actualizados\n    \n),\n\nrenamed as (\n    select\n        address_id,\n        zipcode,\n        country,\n        address,\n        street,\n        address_number,\n        state,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.509015Z", "completed_at": "2024-12-20T13:10:15.537078Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.539900Z", "completed_at": "2024-12-20T13:10:15.539950Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038246870040893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_addresses", "compiled": true, "compiled_code": "\n\nwith \nsource as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses) -- Solo datos nuevos o actualizados\n    \n),\n\nrenamed as (\n    select\n        address_id,\n        zipcode,\n        country,\n        address,\n        street,\n        address_number,\n        state,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.552396Z", "completed_at": "2024-12-20T13:10:15.595272Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.598915Z", "completed_at": "2024-12-20T13:10:15.598999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052866458892822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__addresses_zipcode__10__5.0cf4a94b2e", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        zipcode\n    ) >= 5 and length(\n        zipcode\n    ) <= 10\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.614010Z", "completed_at": "2024-12-20T13:10:15.646342Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.649940Z", "completed_at": "2024-12-20T13:10:15.649983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04351472854614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__addresses_address_id.7adfa006d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\nwhere address_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.663706Z", "completed_at": "2024-12-20T13:10:15.694042Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.696342Z", "completed_at": "2024-12-20T13:10:15.696376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03949999809265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__addresses_address_id.94c6a3ff03", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    address_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\nwhere address_id is not null\ngroup by address_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.707270Z", "completed_at": "2024-12-20T13:10:15.736122Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.738840Z", "completed_at": "2024-12-20T13:10:15.738877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03677868843078613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__category_category_id.7a677dd73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category\nwhere category_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.750701Z", "completed_at": "2024-12-20T13:10:15.777918Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.780262Z", "completed_at": "2024-12-20T13:10:15.780302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03583264350891113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__category_category_id.b5113ca33e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category\nwhere category_id is not null\ngroup by category_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.790822Z", "completed_at": "2024-12-20T13:10:15.818510Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.820896Z", "completed_at": "2024-12-20T13:10:15.820932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0353848934173584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__event_type_event_type_id.29d222ff42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\nwhere event_type_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.831965Z", "completed_at": "2024-12-20T13:10:15.860254Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.862648Z", "completed_at": "2024-12-20T13:10:15.862693Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036504507064819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__event_type_event_type_id.5dd5d67bfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_type_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\nwhere event_type_id is not null\ngroup by event_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.873418Z", "completed_at": "2024-12-20T13:10:15.896371Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.899009Z", "completed_at": "2024-12-20T13:10:15.899048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03120875358581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_events", "compiled": true, "compiled_code": "\n\nwith \n\nfiltered_events as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events)\n    \n),\n\nsource as (\n    select\n        e.event_id,\n        e.page_url,\n        t.event_type,\n        e.user_id,\n        e.product_id,\n        e.session_id,\n        e.created_at,\n        e.llegada_id\n    from \n        filtered_events e\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type t \n        on e.event_type_id = t.event_type_id\n),\n\nrenamed as (\n    select\n        event_id,\n        page_url,\n        event_type,\n        user_id,\n        product_id,\n        session_id,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.909181Z", "completed_at": "2024-12-20T13:10:15.931364Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.934075Z", "completed_at": "2024-12-20T13:10:15.934126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030193090438842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.facts_events", "compiled": true, "compiled_code": "\n\nwith \n\nfiltered_events as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events)\n    \n),\n\nsource as (\n    select\n        e.event_id,\n        e.page_url,\n        t.event_type,\n        e.user_id,\n        e.product_id,\n        e.session_id,\n        e.created_at,\n        e.llegada_id\n    from \n        filtered_events e\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type t \n        on e.event_type_id = t.event_type_id\n),\n\nrenamed as (\n    select\n        event_id,\n        page_url,\n        event_type,\n        user_id,\n        product_id,\n        session_id,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:15.945903Z", "completed_at": "2024-12-20T13:10:15.994390Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:15.996770Z", "completed_at": "2024-12-20T13:10:15.996818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05710339546203613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_match_regex_stg_sql_server_dbo__events_page_url___http_https_.6e0a9d7f44", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(page_url, '^(http|https)://', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.007285Z", "completed_at": "2024-12-20T13:10:16.035671Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.038120Z", "completed_at": "2024-12-20T13:10:16.038152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03602170944213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_created_at.7da8ed3123", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.047825Z", "completed_at": "2024-12-20T13:10:16.071627Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.073892Z", "completed_at": "2024-12-20T13:10:16.073926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030765295028686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_event_id.fec0cbfc6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.085864Z", "completed_at": "2024-12-20T13:10:16.120189Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.123276Z", "completed_at": "2024-12-20T13:10:16.123311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04344820976257324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_llegada_id.b84f693b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.134375Z", "completed_at": "2024-12-20T13:10:16.161105Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.164348Z", "completed_at": "2024-12-20T13:10:16.164390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03534126281738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_session_id.87ef1f5f17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.179009Z", "completed_at": "2024-12-20T13:10:16.221572Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.226147Z", "completed_at": "2024-12-20T13:10:16.226190Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05293750762939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_event_type_id__event_type_id__ref_stg_sql_server_dbo__event_type_.03e592b922", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select event_type_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where event_type_id is not null\n),\n\nparent as (\n    select event_type_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.270929Z", "completed_at": "2024-12-20T13:10:16.316160Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.319814Z", "completed_at": "2024-12-20T13:10:16.319856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08396768569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__events_event_id.8f149a4f3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.336935Z", "completed_at": "2024-12-20T13:10:16.377327Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.380138Z", "completed_at": "2024-12-20T13:10:16.380174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051236629486083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_order_items", "compiled": true, "compiled_code": "\n\nwith \n\nsource_order_items as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items)\n    \n),\n\nfacts_order_items as (\n    select\n        order_items_id,\n        order_id,\n        product_id,\n        quantity,\n        llegada_id\n    from source_order_items  \n)\n\nselect * from facts_order_items", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.391426Z", "completed_at": "2024-12-20T13:10:16.425852Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.428857Z", "completed_at": "2024-12-20T13:10:16.428905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04303789138793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__order_items_quantity__0.edf134e029", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and quantity >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.443989Z", "completed_at": "2024-12-20T13:10:16.486611Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.489955Z", "completed_at": "2024-12-20T13:10:16.490004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05390000343322754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__order_items_order_items_id.000301c747", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_items_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\nwhere order_items_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.511360Z", "completed_at": "2024-12-20T13:10:16.564443Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.567419Z", "completed_at": "2024-12-20T13:10:16.567463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06972956657409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__order_items_order_items_id.4009fa6f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_items_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\nwhere order_items_id is not null\ngroup by order_items_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.582391Z", "completed_at": "2024-12-20T13:10:16.614551Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.617310Z", "completed_at": "2024-12-20T13:10:16.617354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04209637641906738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource_orders as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders)\n    \n),\n\nfacts_orders as (\n    select\n        order_id,\n        address_id,\n        user_id,\n        llegada_id\n    from source_orders\n)\n\nselect * from facts_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.630486Z", "completed_at": "2024-12-20T13:10:16.666440Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.668963Z", "completed_at": "2024-12-20T13:10:16.668996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044814348220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.facts_orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource_orders as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders)\n    \n),\n\nsource_order_items as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders)\n    \n),\n\nfacts_orders as (\n    select\n        o.order_id,\n        o.address_id,\n        o.user_id,\n        oi.order_items_id,\n        oi.product_id,\n        oi.quantity,\n        oi.llegada_id\n    from source_orders o\n    join source_order_items oi on o.order_id = oi.order_id\n)\n\nselect * from facts_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.679847Z", "completed_at": "2024-12-20T13:10:16.705006Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.707702Z", "completed_at": "2024-12-20T13:10:16.707743Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03277420997619629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__orders_shipping_cost__500__0.9a53dc7b86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and shipping_cost >= 0 and shipping_cost <= 500\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.719336Z", "completed_at": "2024-12-20T13:10:16.749089Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.752069Z", "completed_at": "2024-12-20T13:10:16.752146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03832197189331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_created_at.aa4aed5a27", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.766406Z", "completed_at": "2024-12-20T13:10:16.800459Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.803472Z", "completed_at": "2024-12-20T13:10:16.803513Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0440974235534668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_llegada_id.949da46a97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.815526Z", "completed_at": "2024-12-20T13:10:16.847428Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.850696Z", "completed_at": "2024-12-20T13:10:16.850738Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04098176956176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_order_id.25a1d355bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.864138Z", "completed_at": "2024-12-20T13:10:16.899647Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.903415Z", "completed_at": "2024-12-20T13:10:16.903450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.045560359954833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__returns_order_id__order_id__ref_stg_sql_server_dbo__orders_.88c9677bc8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.915934Z", "completed_at": "2024-12-20T13:10:16.950910Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.953829Z", "completed_at": "2024-12-20T13:10:16.953873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0445096492767334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__order_items_order_id__order_id__ref_stg_sql_server_dbo__orders_.72cfa1d8f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:16.967572Z", "completed_at": "2024-12-20T13:10:16.995557Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:16.998712Z", "completed_at": "2024-12-20T13:10:16.998746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0386655330657959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_address_id__address_id__ref_stg_sql_server_dbo__addresses_.7b49372150", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select address_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where address_id is not null\n),\n\nparent as (\n    select address_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.011757Z", "completed_at": "2024-12-20T13:10:17.039061Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.041675Z", "completed_at": "2024-12-20T13:10:17.041708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03673672676086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__orders_order_id.80c9c7c401", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.052238Z", "completed_at": "2024-12-20T13:10:17.076558Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.079561Z", "completed_at": "2024-12-20T13:10:17.079605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03278756141662598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.093255Z", "completed_at": "2024-12-20T13:10:17.125741Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.128884Z", "completed_at": "2024-12-20T13:10:17.128928Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0422511100769043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.142410Z", "completed_at": "2024-12-20T13:10:17.174567Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.178160Z", "completed_at": "2024-12-20T13:10:17.178209Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04201054573059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__products_inventory__0.d8fc322441", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and inventory >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.192161Z", "completed_at": "2024-12-20T13:10:17.225671Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.228666Z", "completed_at": "2024-12-20T13:10:17.228776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04323124885559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__products_precio__0.91d0218749", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and precio >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.243410Z", "completed_at": "2024-12-20T13:10:17.273538Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.276418Z", "completed_at": "2024-12-20T13:10:17.276459Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04022979736328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__products_product_id.fcbd02a208", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.288850Z", "completed_at": "2024-12-20T13:10:17.316328Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.318885Z", "completed_at": "2024-12-20T13:10:17.318921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03592705726623535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__budget_product_id__product_id__ref_stg_sql_server_dbo__products_.22dde86a0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.328090Z", "completed_at": "2024-12-20T13:10:17.355101Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.358060Z", "completed_at": "2024-12-20T13:10:17.358096Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034621238708496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__reviews_product_id__product_id__ref_stg_sql_server_dbo__products_.c7fd681407", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.367537Z", "completed_at": "2024-12-20T13:10:17.397068Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.400889Z", "completed_at": "2024-12-20T13:10:17.400932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03809952735900879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_product_id__product_id__ref_stg_sql_server_dbo__products_.6175065fb0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.412125Z", "completed_at": "2024-12-20T13:10:17.437712Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.440223Z", "completed_at": "2024-12-20T13:10:17.440261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03355050086975098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__order_items_product_id__product_id__ref_stg_sql_server_dbo__products_.9298c4739b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.451253Z", "completed_at": "2024-12-20T13:10:17.477460Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.480619Z", "completed_at": "2024-12-20T13:10:17.480654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03508257865905762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__products_product_id.64430c143e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.491685Z", "completed_at": "2024-12-20T13:10:17.517736Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.520127Z", "completed_at": "2024-12-20T13:10:17.520163Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03423786163330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__promos_EUR_discount__1000__0.f800ea0cfd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and EUR_discount >= 0 and EUR_discount <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.531785Z", "completed_at": "2024-12-20T13:10:17.561061Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.563558Z", "completed_at": "2024-12-20T13:10:17.563593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037424564361572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__promos_promo_id.ef15ef851e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect promo_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\nwhere promo_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.574787Z", "completed_at": "2024-12-20T13:10:17.602472Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.605533Z", "completed_at": "2024-12-20T13:10:17.605570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03628802299499512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_promo_id__promo_id__ref_stg_sql_server_dbo__promos_.844e202eae", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select promo_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where promo_id is not null\n),\n\nparent as (\n    select promo_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.617481Z", "completed_at": "2024-12-20T13:10:17.641802Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.644082Z", "completed_at": "2024-12-20T13:10:17.644119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03316354751586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__promos_promo_id.7dc1b5a0df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    promo_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\nwhere promo_id is not null\ngroup by promo_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.659496Z", "completed_at": "2024-12-20T13:10:17.683443Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.685877Z", "completed_at": "2024-12-20T13:10:17.685912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03532552719116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__shipping_service_shipping_service_id.6100e89129", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shipping_service_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\nwhere shipping_service_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.697735Z", "completed_at": "2024-12-20T13:10:17.728230Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.731443Z", "completed_at": "2024-12-20T13:10:17.731486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04001593589782715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_shipping_service_id__shipping_service_id__ref_stg_sql_server_dbo__shipping_service_.243663b109", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select shipping_service_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where shipping_service_id is not null\n),\n\nparent as (\n    select shipping_service_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.743808Z", "completed_at": "2024-12-20T13:10:17.770162Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.773751Z", "completed_at": "2024-12-20T13:10:17.773786Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03566718101501465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__shipping_service_shipping_service_id.e659a814a9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    shipping_service_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\nwhere shipping_service_id is not null\ngroup by shipping_service_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.785875Z", "completed_at": "2024-12-20T13:10:17.812372Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.815126Z", "completed_at": "2024-12-20T13:10:17.815156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035082340240478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_orders", "compiled": true, "compiled_code": "\n\nwith \n\n-- Filtra datos incrementales antes de las uniones\nfiltered_orders as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders)\n    \n),\n\n-- Construye la dimension combinando con otras tablas\ndim_orders as (\n    select\n        o.order_id,\n        s.shipping_service,\n        o.shipping_cost,\n        o.created_at,\n        o.estimated_delivery_at,\n        p.name as nombre_promocion,\n        p.EUR_discount,\n        p.status as promo_estado,\n        st.status as order_status,\n        o.order_cost,\n        o.order_total,\n        o.delivered_at,\n        o.tracking_id,\n        o.llegada_id\n    from \n        filtered_orders o\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos p on o.promo_id = p.promo_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service s on o.shipping_service_id = s.shipping_service_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status st on o.status_id = st.status_id\n)\n\nselect * from dim_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.826074Z", "completed_at": "2024-12-20T13:10:17.852966Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.855432Z", "completed_at": "2024-12-20T13:10:17.855498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03428006172180176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_orders", "compiled": true, "compiled_code": "\n\nwith \n\n-- Filtra datos incrementales antes de las uniones\nfiltered_orders as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders)\n    \n),\n\n-- Construye la dimension combinando con otras tablas\ndim_orders as (\n    select\n        o.order_id,\n        s.shipping_service,\n        o.shipping_cost,\n        o.created_at,\n        o.estimated_delivery_at,\n        p.name as nombre_promocion,\n        p.EUR_discount,\n        p.status as promo_estado,\n        st.status as order_status,\n        o.order_cost,\n        o.order_total,\n        o.delivered_at,\n        o.tracking_id,\n        o.llegada_id\n    from \n        filtered_orders o\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos p on o.promo_id = p.promo_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service s on o.shipping_service_id = s.shipping_service_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status st on o.status_id = st.status_id\n)\n\nselect * from dim_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.866631Z", "completed_at": "2024-12-20T13:10:17.903775Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.906165Z", "completed_at": "2024-12-20T13:10:17.906201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044986724853515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_in_set_stg_sql_server_dbo__status_status__preparing__delivered__shipped.17dbd2f562", "compiled": true, "compiled_code": "\n\nwith all_values as (\n\n    select\n        status as value_field\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\n    \n\n),\nset_values as (\n\n    select\n        cast('preparing' as TEXT) as value_field\n    union all\n    select\n        cast('delivered' as TEXT) as value_field\n    union all\n    select\n        cast('shipped' as TEXT) as value_field\n    \n    \n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        v.value_field\n    from\n        all_values v\n        left join\n        set_values s on v.value_field = s.value_field\n    where\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.926525Z", "completed_at": "2024-12-20T13:10:17.958883Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:17.961877Z", "completed_at": "2024-12-20T13:10:17.961912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04175209999084473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__status_status_id.3ccf2cdfcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\nwhere status_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:17.974435Z", "completed_at": "2024-12-20T13:10:18.013041Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.016393Z", "completed_at": "2024-12-20T13:10:18.016427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04795432090759277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_status_id__status_id__ref_stg_sql_server_dbo__status_.f79d37ea89", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select status_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where status_id is not null\n),\n\nparent as (\n    select status_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.028787Z", "completed_at": "2024-12-20T13:10:18.067667Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.070920Z", "completed_at": "2024-12-20T13:10:18.070965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04811668395996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__status_status_id.dceb04c7ab", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    status_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\nwhere status_id is not null\ngroup by status_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.082202Z", "completed_at": "2024-12-20T13:10:18.118162Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.121019Z", "completed_at": "2024-12-20T13:10:18.121062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044347524642944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users)\n    \n),\n\nrenamed as (\n    select\n        user_id,\n        updated_at,\n        address_id,\n        last_name,\n        created_at,\n        phone_number,\n        first_name,\n        email,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.132424Z", "completed_at": "2024-12-20T13:10:18.154650Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.157075Z", "completed_at": "2024-12-20T13:10:18.157108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029901504516601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users)\n    \n),\n\nrenamed as (\n    select\n        user_id,\n        updated_at,\n        address_id,\n        last_name,\n        created_at,\n        phone_number,\n        first_name,\n        email,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.166496Z", "completed_at": "2024-12-20T13:10:18.195354Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.198995Z", "completed_at": "2024-12-20T13:10:18.199074Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037161827087402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__users_first_name__50__1.94fa964027", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        first_name\n    ) >= 1 and length(\n        first_name\n    ) <= 50\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.212154Z", "completed_at": "2024-12-20T13:10:18.246570Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.250061Z", "completed_at": "2024-12-20T13:10:18.250109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04383420944213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__users_last_name__50__1.b6d1936e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        last_name\n    ) >= 1 and length(\n        last_name\n    ) <= 50\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.264568Z", "completed_at": "2024-12-20T13:10:18.299074Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.302029Z", "completed_at": "2024-12-20T13:10:18.302070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04506492614746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_match_regex_stg_sql_server_dbo__users_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.323eecfc64", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(email, '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.315178Z", "completed_at": "2024-12-20T13:10:18.445114Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.447933Z", "completed_at": "2024-12-20T13:10:18.447969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13899946212768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_created_at.188683f156", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.461682Z", "completed_at": "2024-12-20T13:10:18.488344Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.491446Z", "completed_at": "2024-12-20T13:10:18.491480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03731822967529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_llegada_id.f27d0e2381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.502512Z", "completed_at": "2024-12-20T13:10:18.530800Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.533708Z", "completed_at": "2024-12-20T13:10:18.533742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0367884635925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_updated_at.e4ba690261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.547431Z", "completed_at": "2024-12-20T13:10:18.578791Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.581903Z", "completed_at": "2024-12-20T13:10:18.581944Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04254722595214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_user_id.0bc26a926a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.594849Z", "completed_at": "2024-12-20T13:10:18.630007Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.633607Z", "completed_at": "2024-12-20T13:10:18.633655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04512166976928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__returns_user_id__user_id__ref_stg_sql_server_dbo__users_.33205d9195", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.648222Z", "completed_at": "2024-12-20T13:10:18.683338Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.686518Z", "completed_at": "2024-12-20T13:10:18.686552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04507327079772949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__reviews_user_id__user_id__ref_stg_sql_server_dbo__users_.aec5e65c76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.704474Z", "completed_at": "2024-12-20T13:10:18.743143Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.746201Z", "completed_at": "2024-12-20T13:10:18.746242Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052014827728271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_user_id__user_id__ref_stg_sql_server_dbo__users_.345bb30f84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.762335Z", "completed_at": "2024-12-20T13:10:18.788392Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.791750Z", "completed_at": "2024-12-20T13:10:18.791785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03598213195800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_user_id__user_id__ref_stg_sql_server_dbo__users_.78d51ec636", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.802215Z", "completed_at": "2024-12-20T13:10:18.828541Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.831630Z", "completed_at": "2024-12-20T13:10:18.831662Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034982919692993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__users_address_id__address_id__ref_stg_sql_server_dbo__addresses_.256c72b0e6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select address_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    where address_id is not null\n),\n\nparent as (\n    select address_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.842392Z", "completed_at": "2024-12-20T13:10:18.863956Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.866188Z", "completed_at": "2024-12-20T13:10:18.866223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02916264533996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__users_user_id.5dc7e3213c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.875250Z", "completed_at": "2024-12-20T13:10:18.901338Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.903711Z", "completed_at": "2024-12-20T13:10:18.903777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032776832580566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo_snap_product", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_GOLD_DB.snapshots.products_snapshot\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        price::decimal(10, 2) as precio,\n        name as nombre_producto,\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        inventory,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\nno_products as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        0 as precio,\n        'no products' as nombre_producto,\n        md5(cast(coalesce(cast('no products' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        0 as inventory,\n        '0' as llegada_id\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by product_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_products\n    )\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.912865Z", "completed_at": "2024-12-20T13:10:18.937821Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.940431Z", "completed_at": "2024-12-20T13:10:18.940470Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03182673454284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__snap_reviews", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_GOLD_DB.snapshots.reviews_snapshot\n    ),\n\n    renamed as (\n\n        select\n            review_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n            rating::int as rating,\n            comments,\n            CAST(created_at AS DATE) as created_at,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.951627Z", "completed_at": "2024-12-20T13:10:18.970597Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:18.974496Z", "completed_at": "2024-12-20T13:10:18.974564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029048919677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_usuarios_activos", "compiled": true, "compiled_code": "WITH usuarios_activos AS (\n    SELECT\n        df.month AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fe.user_id) AS usuarios_activos\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events fe\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    ON\n        fe.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n)\nSELECT * FROM usuarios_activos", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_usuarios_activos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:18.983497Z", "completed_at": "2024-12-20T13:10:19.002324Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.004788Z", "completed_at": "2024-12-20T13:10:19.004872Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025812864303588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.usuarios_activos", "compiled": true, "compiled_code": "WITH usuarios_activos AS (\n    SELECT\n        df.month AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fe.user_id) AS usuarios_activos\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events fe\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    ON\n        fe.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n)\nSELECT * FROM usuarios_activos", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.usuarios_activos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.014804Z", "completed_at": "2024-12-20T13:10:19.035900Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.038620Z", "completed_at": "2024-12-20T13:10:19.038654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028751373291015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_recurrencia", "compiled": true, "compiled_code": "WITH usuarios_ordenes AS (\n    SELECT\n        fo.user_id,\n        COUNT(fo.order_id) AS total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders fo\n    GROUP BY\n        fo.user_id\n),\ntasa_recurrencia AS (\n    SELECT\n        COUNT(CASE WHEN total_ordenes > 1 THEN 1 END) * 1.0 / COUNT(*) AS tasa_recurrencia\n    FROM usuarios_ordenes\n)\nSELECT * FROM tasa_recurrencia", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_recurrencia"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.048226Z", "completed_at": "2024-12-20T13:10:19.067859Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.070819Z", "completed_at": "2024-12-20T13:10:19.070853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027521848678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_recurrencia", "compiled": true, "compiled_code": "WITH usuarios_ordenes AS (\n    SELECT\n        fo.user_id,\n        COUNT(DISTINCT fo.order_id) AS total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    GROUP BY\n        fo.user_id\n),\ntasa_recurrencia AS (\n    SELECT\n        COUNT(CASE WHEN total_ordenes > 1 THEN 1 END) * 1.0 / COUNT(*) AS tasa_recurrencia\n    FROM usuarios_ordenes\n)\nSELECT * FROM tasa_recurrencia", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_recurrencia"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.082012Z", "completed_at": "2024-12-20T13:10:19.105083Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.107737Z", "completed_at": "2024-12-20T13:10:19.107777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031406402587890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_avg_revisiones_productos", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\nproducto_calificacion_promedio AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        cp.calificacion_promedio,\n        cp.numero_calificaciones\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON cp.product_id = dp.product_id\n    ORDER BY \n        cp.calificacion_promedio DESC\n)\n\nselect * from producto_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_avg_revisiones_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.118329Z", "completed_at": "2024-12-20T13:10:19.138664Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.141336Z", "completed_at": "2024-12-20T13:10:19.141369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02781057357788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_categoria_avg_calificaciones", "compiled": true, "compiled_code": "WITH calificaciones_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dr.rating) AS promedio_calificacion,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        dr.product_id = dp.product_id\n    GROUP BY dp.category\n)\nSELECT * FROM calificaciones_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_categoria_avg_calificaciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.150420Z", "completed_at": "2024-12-20T13:10:19.170828Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.173547Z", "completed_at": "2024-12-20T13:10:19.173582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02754688262939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_categoria_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_categoria AS (\n    SELECT\n        dp.category,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY dp.category\n),\ncategoria_max_facturacion AS (\n    SELECT\n        category,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_categoria\n    ORDER BY total_facturado DESC\n)\nSELECT * FROM categoria_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_categoria_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.182882Z", "completed_at": "2024-12-20T13:10:19.202922Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.205651Z", "completed_at": "2024-12-20T13:10:19.205696Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02741074562072754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_inventario_promedio_categoria", "compiled": true, "compiled_code": "WITH inventario_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dp.inventory) AS inventario_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    GROUP BY\n        dp.category\n)\nSELECT * FROM inventario_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_inventario_promedio_categoria"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.218141Z", "completed_at": "2024-12-20T13:10:19.249219Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.251828Z", "completed_at": "2024-12-20T13:10:19.251871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04025888442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_producto_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_producto AS (\n    SELECT\n        dp.product_id,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\nproducto_max_facturacion AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_producto\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON facturacion_por_producto.product_id = dp.product_id\n    ORDER BY\n        total_facturado DESC\n)\nSELECT * FROM producto_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_producto_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.276247Z", "completed_at": "2024-12-20T13:10:19.296993Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.299838Z", "completed_at": "2024-12-20T13:10:19.299877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029750823974609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_devoluciones", "compiled": true, "compiled_code": "WITH devoluciones AS (\n    SELECT\n        fo.product_id,\n        COUNT(dr.return_id) as devoluciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    ON\n        dr.order_id = fo.order_id\n    GROUP BY\n        fo.product_id\n),\n\ntotal_producto_orders AS (\n    SELECT\n        dp.product_id,\n        COUNT(DISTINCT fo.order_id) as total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\nproducto_tasa_devoluciones AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        devoluciones / total_ordenes as tasa_devoluciones\n    FROM devoluciones\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON devoluciones.product_id = dp.product_id\n    JOIN total_producto_orders tpo\n    ON dp.product_id = tpo.product_id\n    ORDER BY\n        tasa_devoluciones DESC\n)\n\nSELECT * FROM producto_tasa_devoluciones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_devoluciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.309305Z", "completed_at": "2024-12-20T13:10:19.328635Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.332759Z", "completed_at": "2024-12-20T13:10:19.332790Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027698993682861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.avg_revisiones_productos", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\nproducto_calificacion_promedio AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        cp.calificacion_promedio,\n        cp.numero_calificaciones\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON cp.product_id = dp.product_id\n    ORDER BY \n        cp.calificacion_promedio DESC\n)\n\nselect * from producto_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.avg_revisiones_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.341702Z", "completed_at": "2024-12-20T13:10:19.360989Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.363217Z", "completed_at": "2024-12-20T13:10:19.363251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026123762130737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.categoria_avg_calificaciones", "compiled": true, "compiled_code": "WITH calificaciones_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dr.rating) AS promedio_calificacion,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        dr.product_id = dp.product_id\n    GROUP BY dp.category\n)\nSELECT * FROM calificaciones_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.categoria_avg_calificaciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.372357Z", "completed_at": "2024-12-20T13:10:19.392674Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.394987Z", "completed_at": "2024-12-20T13:10:19.395019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027242422103881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.categoria_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_categoria AS (\n    SELECT\n        dp.category,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY dp.category\n),\ncategoria_max_facturacion AS (\n    SELECT\n        category,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_categoria\n    ORDER BY total_facturado DESC\n)\nSELECT * FROM categoria_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.categoria_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.404212Z", "completed_at": "2024-12-20T13:10:19.423329Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.426492Z", "completed_at": "2024-12-20T13:10:19.426526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026660680770874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.inventario_promedio_categoria", "compiled": true, "compiled_code": "WITH inventario_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dp.inventory) AS inventario_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    GROUP BY\n        dp.category\n)\nSELECT * FROM inventario_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.inventario_promedio_categoria"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.436591Z", "completed_at": "2024-12-20T13:10:19.467943Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.471197Z", "completed_at": "2024-12-20T13:10:19.471239Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03975868225097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.producto_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_producto AS (\n    SELECT\n        dp.product_id,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\nproducto_max_facturacion AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        total_facturado,\n        total_vendido\n        FROM facturacion_por_producto\n        JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n        ON facturacion_por_producto.product_id = dp.product_id\n    ORDER BY\n        total_facturado DESC\n)\nSELECT * FROM producto_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.producto_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.483881Z", "completed_at": "2024-12-20T13:10:19.513790Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.516878Z", "completed_at": "2024-12-20T13:10:19.516914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0383305549621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_devoluciones", "compiled": true, "compiled_code": "WITH devoluciones AS (\n    SELECT\n        dp.product_id,\n        COUNT(dr.return_id) as devoluciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    ON\n        dr.order_id = fo.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\ntotal_producto_orders AS (\n    SELECT\n        dp.product_id,\n        COUNT(fo.order_id) as total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\nproducto_tasa_devoluciones AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        devoluciones / total_ordenes as tasa_devoluciones\n    FROM devoluciones\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON devoluciones.product_id = dp.product_id\n    JOIN total_producto_orders tpo\n    ON dp.product_id = tpo.product_id\n    ORDER BY\n        tasa_devoluciones DESC\n)\n\nSELECT * FROM producto_tasa_devoluciones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_devoluciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.529754Z", "completed_at": "2024-12-20T13:10:19.557638Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.560629Z", "completed_at": "2024-12-20T13:10:19.560666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037502288818359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ventas_estado_categorias", "compiled": true, "compiled_code": "WITH ventas_facturacion_por_estado AS (\n    SELECT\n        dp.category AS categoria,\n        da.state AS estado,\n        da.country AS pais,\n        SUM(fo.quantity) AS total_ventas,\n        SUM(fo.quantity * dp.precio) AS total_facturacion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp ON fo.product_id = dp.product_id\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses da ON fo.address_id = da.address_id\n    GROUP BY\n        dp.category, da.state, da.country\n),\nestado_mas_vendido AS (\n    SELECT\n        categoria,\n        estado AS estado_mas_vendido,\n        pais AS pais_estado_mas_vendido,\n        total_ventas\n    FROM (\n        SELECT\n            categoria,\n            estado,\n            pais,\n            total_ventas,\n            RANK() OVER (PARTITION BY categoria ORDER BY total_ventas DESC,estado ASC) AS rank_ventas\n        FROM ventas_facturacion_por_estado\n    ) ranked_ventas\n    WHERE rank_ventas = 1\n),\nestado_mas_facturado AS (\n    SELECT\n        categoria,\n        estado AS estado_mas_facturado,\n        pais AS pais_estado_mas_facturado,\n        total_facturacion\n    FROM (\n        SELECT\n            categoria,\n            estado,\n            pais,\n            total_facturacion,\n            RANK() OVER (PARTITION BY categoria ORDER BY total_facturacion DESC, estado ASC) AS rank_facturacion\n        FROM ventas_facturacion_por_estado\n    ) ranked_facturacion\n    WHERE rank_facturacion = 1\n)\nSELECT\n    emv.categoria,\n    emv.estado_mas_vendido,\n    emv.pais_estado_mas_vendido,\n    emv.total_ventas AS ventas_estado_mas_vendido,\n    emf.estado_mas_facturado,\n    emf.pais_estado_mas_facturado,\n    emf.total_facturacion AS facturacion_estado_mas_facturado\nFROM\n    estado_mas_vendido emv\nFULL JOIN estado_mas_facturado emf ON emv.categoria = emf.categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ventas_estado_categorias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.572479Z", "completed_at": "2024-12-20T13:10:19.601756Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.604976Z", "completed_at": "2024-12-20T13:10:19.605008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03833770751953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ventas_estado_productos", "compiled": true, "compiled_code": "WITH ventas_facturacion_por_estado AS (\n    SELECT\n        dp.product_id AS producto_id,\n        dp.nombre_producto AS producto,\n        da.state AS estado,\n        da.country AS pais,\n        SUM(fo.quantity) AS total_ventas,\n        SUM(fo.quantity * dp.precio) AS total_facturacion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp ON fo.product_id = dp.product_id\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses da ON fo.address_id = da.address_id\n    GROUP BY\n        dp.product_id, dp.nombre_producto, da.state, da.country\n),\nestado_mas_vendido AS (\n    SELECT\n        producto_id,\n        producto,\n        estado AS estado_mas_vendido,\n        pais AS pais_estado_mas_vendido,\n        total_ventas\n    FROM (\n        SELECT\n            producto_id,\n            producto,\n            estado,\n            pais,\n            total_ventas,\n            RANK() OVER (PARTITION BY producto_id ORDER BY total_ventas DESC, estado ASC) AS rank_ventas\n        FROM ventas_facturacion_por_estado\n    ) ranked_ventas\n    WHERE rank_ventas = 1\n),\nestado_mas_facturado AS (\n    SELECT\n        producto_id,\n        producto,\n        estado AS estado_mas_facturado,\n        pais AS pais_estado_mas_facturado,\n        total_facturacion\n    FROM (\n        SELECT\n            producto_id,\n            producto,\n            estado,\n            pais,\n            total_facturacion,\n            RANK() OVER (PARTITION BY producto_id ORDER BY total_facturacion DESC, estado ASC) AS rank_facturacion\n        FROM ventas_facturacion_por_estado\n    ) ranked_facturacion\n    WHERE rank_facturacion = 1\n)\nSELECT\n    emv.producto_id AS producto_id,\n    emv.producto AS producto,\n    emv.estado_mas_vendido,\n    emv.pais_estado_mas_vendido,\n    emv.total_ventas AS ventas_estado_mas_vendido,\n    emf.estado_mas_facturado,\n    emf.pais_estado_mas_facturado,\n    emf.total_facturacion AS facturacion_estado_mas_facturado\nFROM\n    estado_mas_vendido emv\nFULL JOIN estado_mas_facturado emf ON emv.producto_id = emf.producto_id", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ventas_estado_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.616780Z", "completed_at": "2024-12-20T13:10:19.648224Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.651104Z", "completed_at": "2024-12-20T13:10:19.651146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04078507423400879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_coste_promedio_envio", "compiled": true, "compiled_code": "WITH costo_envio AS (\n    SELECT\n        AVG(do.shipping_cost) AS costo_promedio_envio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM costo_envio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_coste_promedio_envio"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.665823Z", "completed_at": "2024-12-20T13:10:19.693151Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.696161Z", "completed_at": "2024-12-20T13:10:19.696205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03728008270263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_desempeno_promociones", "compiled": true, "compiled_code": "WITH desempeno_promociones AS (\n    WITH descuentos_unicos AS (\n        SELECT\n            foi.order_id,\n            do.nombre_promocion,\n            do.EUR_discount\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.nombre_promocion, do.EUR_discount\n    )\n\n    SELECT\n        du.nombre_promocion,\n        COUNT(DISTINCT du.order_id) AS numero_ordenes_afectadas,\n        SUM(du.EUR_discount) AS total_descuentos,\n        AVG(do.order_total) AS gasto_promedio_por_orden\n    FROM\n        descuentos_unicos du\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        du.order_id = do.order_id\n    GROUP BY\n        du.nombre_promocion\n)\n\nSELECT * FROM desempeno_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_desempeno_promociones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.708115Z", "completed_at": "2024-12-20T13:10:19.734903Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.737982Z", "completed_at": "2024-12-20T13:10:19.738023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03551149368286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_eficiencia_envios", "compiled": true, "compiled_code": "WITH shipping_efficiency AS (\n    WITH unique_shipping_costs AS (\n        SELECT\n            foi.order_id,\n            do.shipping_service,\n            do.shipping_cost\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.shipping_service, do.shipping_cost\n    )\n    SELECT\n        usc.shipping_service,\n        COUNT(DISTINCT usc.order_id) AS total_envios,\n        SUM(usc.shipping_cost) AS costo_envio_total,\n        AVG(usc.shipping_cost) AS costo_envio_promedio,\n        AVG(DATEDIFF(DAY, do.created_at, do.delivered_at)) AS promedio_tiempo_entrega\n    FROM\n        unique_shipping_costs usc\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        usc.order_id = do.order_id\n    GROUP BY\n        usc.shipping_service\n    ORDER BY costo_envio_total DESC\n)\nSELECT * FROM shipping_efficiency", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_eficiencia_envios"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.750499Z", "completed_at": "2024-12-20T13:10:19.773688Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.776626Z", "completed_at": "2024-12-20T13:10:19.776659Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202223777770996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_entregas_a_tiempo", "compiled": true, "compiled_code": "WITH entregas_tiempo AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at <= do.estimated_delivery_at THEN 1 END) * 1.0 / COUNT(*) AS tasa_entregas_tiempo\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM entregas_tiempo", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_entregas_a_tiempo"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.786111Z", "completed_at": "2024-12-20T13:10:19.807192Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.809977Z", "completed_at": "2024-12-20T13:10:19.810006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028536558151245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_ordenes_ventas_mes", "compiled": true, "compiled_code": "WITH ordenes_ventas_agrupadas AS (\n    SELECT\n        TO_CHAR(DATE_FROM_PARTS(df.year, df.month, 1), 'Month') AS mes,\n        df.year AS anyo,\n        COUNT(fo.order_id) AS total_ordenes,\n        SUM(do.order_total) AS valor_total_ventas\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        fo.order_id = do.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    ON\n        do.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n    ORDER BY\n        total_ordenes DESC\n)\nSELECT * FROM ordenes_ventas_agrupadas", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_ordenes_ventas_mes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.826406Z", "completed_at": "2024-12-20T13:10:19.881345Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.884901Z", "completed_at": "2024-12-20T13:10:19.884943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0700063705444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_porcentaje_entregas_tardias", "compiled": true, "compiled_code": "WITH entregas_tardias AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at > do.estimated_delivery_at THEN 1 END) * 1.0 /\n        COUNT(*) * 100 AS porcentaje_entregas_tardias\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n)\nSELECT * FROM entregas_tardias", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_porcentaje_entregas_tardias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.908004Z", "completed_at": "2024-12-20T13:10:19.943886Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:19.946883Z", "completed_at": "2024-12-20T13:10:19.946929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.047252655029296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_ordenes_con_promos", "compiled": true, "compiled_code": "WITH ordenes_promociones AS (\n    SELECT\n        COUNT(CASE WHEN do.EUR_discount > 0 THEN 1 END) * 1.0 / COUNT(*) AS tasa_ordenes_promocion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM ordenes_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_ordenes_con_promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:19.961959Z", "completed_at": "2024-12-20T13:10:20.009708Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.012348Z", "completed_at": "2024-12-20T13:10:20.012380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05739021301269531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tiempo_avanzado", "compiled": true, "compiled_code": "WITH ventas_por_tiempo AS (\n    SELECT\n        df.month AS mes,\n        df.quarter AS trimestre,\n        df.date_day,\n        do.order_total\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    LEFT JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        df.date_day = do.created_at\n),\nventas_agregadas AS (\n    SELECT\n        mes,\n        trimestre,\n        COALESCE(SUM(order_total),0) AS ventas_totales_mes,\n        COALESCE(SUM(SUM(order_total)) OVER (PARTITION BY trimestre),0) AS ventas_totales_trimestre\n    FROM\n        ventas_por_tiempo\n    GROUP BY\n        mes, trimestre\n)\n\nSELECT\n    TO_CHAR(DATE_FROM_PARTS(1, mes, 1), 'Month') AS Meses,\n    trimestre,\n    ventas_totales_mes,\n    ventas_totales_trimestre,\n    COALESCE(ventas_totales_mes - LAG(ventas_totales_mes) OVER (ORDER BY mes), 0) AS variacion_mensual,\n    COALESCE(ventas_totales_trimestre - LAG(ventas_totales_trimestre) OVER (ORDER BY trimestre), 0) AS variacion_trimestral\nFROM\n    ventas_agregadas\nORDER BY\n    mes", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tiempo_avanzado"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.023892Z", "completed_at": "2024-12-20T13:10:20.051507Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.054269Z", "completed_at": "2024-12-20T13:10:20.054311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03633761405944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tiempo_promedio_entrega", "compiled": true, "compiled_code": "WITH tiempo_entrega AS (\n    SELECT\n        DATEDIFF(day, do.created_at, do.delivered_at) AS dias_entrega\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n),\npromedio_entrega AS (\n    SELECT\n        AVG(dias_entrega) AS tiempo_promedio_entrega\n    FROM tiempo_entrega\n)\nSELECT * FROM promedio_entrega", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tiempo_promedio_entrega"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.066678Z", "completed_at": "2024-12-20T13:10:20.091308Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.094124Z", "completed_at": "2024-12-20T13:10:20.094168Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03352999687194824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.coste_promedio_envio", "compiled": true, "compiled_code": "WITH costo_envio AS (\n    SELECT\n        AVG(do.shipping_cost) AS costo_promedio_envio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM costo_envio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.coste_promedio_envio"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.106844Z", "completed_at": "2024-12-20T13:10:20.138029Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.142253Z", "completed_at": "2024-12-20T13:10:20.142301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04102015495300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.desempeno_promociones", "compiled": true, "compiled_code": "WITH desempeno_promociones AS (\n    WITH descuentos_unicos AS (\n        SELECT\n            foi.order_id,\n            do.nombre_promocion,\n            do.EUR_discount\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.nombre_promocion, do.EUR_discount\n    )\n\n    SELECT\n        du.nombre_promocion,\n        COUNT(DISTINCT du.order_id) AS numero_ordenes_afectadas,\n        SUM(du.EUR_discount) AS total_descuentos,\n        AVG(do.order_total) AS gasto_promedio_por_orden\n    FROM\n        descuentos_unicos du\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        du.order_id = do.order_id\n    GROUP BY\n        du.nombre_promocion\n)\n\nSELECT * FROM desempeno_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.desempeno_promociones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.157579Z", "completed_at": "2024-12-20T13:10:20.180810Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.183254Z", "completed_at": "2024-12-20T13:10:20.183287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03284645080566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.eficiencia_envios", "compiled": true, "compiled_code": "WITH shipping_efficiency AS (\n    WITH unique_shipping_costs AS (\n        SELECT\n            foi.order_id,\n            do.shipping_service,\n            do.shipping_cost\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.shipping_service, do.shipping_cost\n    )\n    SELECT\n        usc.shipping_service,\n        COUNT(DISTINCT usc.order_id) AS total_envios,\n        SUM(usc.shipping_cost) AS costo_envio_total,\n        AVG(usc.shipping_cost) AS costo_envio_promedio,\n        AVG(DATEDIFF(DAY, do.created_at, do.delivered_at)) AS promedio_tiempo_entrega\n    FROM\n        unique_shipping_costs usc\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        usc.order_id = do.order_id\n    GROUP BY\n        usc.shipping_service\n    ORDER BY costo_envio_total DESC\n)\nSELECT * FROM shipping_efficiency", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.eficiencia_envios"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.193056Z", "completed_at": "2024-12-20T13:10:20.213182Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.215776Z", "completed_at": "2024-12-20T13:10:20.215809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027686595916748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.entregas_a_tiempo", "compiled": true, "compiled_code": "WITH entregas_tiempo AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at <= do.estimated_delivery_at THEN 1 END) * 1.0 / COUNT(*) AS tasa_entregas_tiempo\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM entregas_tiempo", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.entregas_a_tiempo"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.225815Z", "completed_at": "2024-12-20T13:10:20.247969Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.251393Z", "completed_at": "2024-12-20T13:10:20.251437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030563831329345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ordenes_ventas_mes", "compiled": true, "compiled_code": "WITH ordenes_ventas_agrupadas AS (\n    SELECT\n        TO_CHAR(DATE_FROM_PARTS(df.year, df.month, 1), 'Month') AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fo.order_id) AS total_ordenes,\n        SUM(do.order_total) AS valor_total_ventas\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        fo.order_id = do.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    ON\n        do.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n    ORDER BY\n        total_ordenes DESC\n)\nSELECT * FROM ordenes_ventas_agrupadas", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ordenes_ventas_mes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.266868Z", "completed_at": "2024-12-20T13:10:20.288200Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.291143Z", "completed_at": "2024-12-20T13:10:20.291182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03145480155944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.porcentaje_entregas_tardias", "compiled": true, "compiled_code": "WITH entregas_tardias AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at > do.estimated_delivery_at THEN 1 END) * 1.0 /\n        COUNT(*) * 100 AS porcentaje_entregas_tardias\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n)\nSELECT * FROM entregas_tardias", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.porcentaje_entregas_tardias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.303964Z", "completed_at": "2024-12-20T13:10:20.325470Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.328656Z", "completed_at": "2024-12-20T13:10:20.328787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03139352798461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_ordenes_con_promos", "compiled": true, "compiled_code": "WITH ordenes_promociones AS (\n    SELECT\n        COUNT(CASE WHEN do.EUR_discount > 0 THEN 1 END) * 1.0 / COUNT(*) AS tasa_ordenes_promocion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM ordenes_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_ordenes_con_promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.341886Z", "completed_at": "2024-12-20T13:10:20.374107Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.377762Z", "completed_at": "2024-12-20T13:10:20.377804Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04275965690612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tiempo_avanzado", "compiled": true, "compiled_code": "WITH ventas_por_tiempo AS (\n    SELECT\n        df.month AS mes,\n        df.quarter AS trimestre,\n        df.date_day,\n        do.order_total\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    LEFT JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        df.date_day = do.created_at\n),\nventas_agregadas AS (\n    SELECT\n        mes,\n        trimestre,\n        COALESCE(SUM(order_total),0) AS ventas_totales_mes,\n        COALESCE(SUM(SUM(order_total)) OVER (PARTITION BY trimestre),0) AS ventas_totales_trimestre\n    FROM\n        ventas_por_tiempo\n    GROUP BY\n        mes, trimestre\n)\n\nSELECT\n    TO_CHAR(DATE_FROM_PARTS(1, mes, 1), 'Month') AS Meses,\n    trimestre,\n    ventas_totales_mes,\n    ventas_totales_trimestre,\n    COALESCE(ventas_totales_mes - LAG(ventas_totales_mes) OVER (ORDER BY mes), 0) AS variacion_mensual,\n    COALESCE(ventas_totales_trimestre - LAG(ventas_totales_trimestre) OVER (ORDER BY trimestre), 0) AS variacion_trimestral\nFROM\n    ventas_agregadas\nORDER BY\n    mes", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tiempo_avanzado"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.388157Z", "completed_at": "2024-12-20T13:10:20.412156Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.415367Z", "completed_at": "2024-12-20T13:10:20.415408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03223252296447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tiempo_promedio_entrega", "compiled": true, "compiled_code": "WITH tiempo_entrega AS (\n    SELECT\n        DATEDIFF(day, do.created_at, do.delivered_at) AS dias_entrega\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n),\npromedio_entrega AS (\n    SELECT\n        AVG(dias_entrega) AS tiempo_promedio_entrega\n    FROM tiempo_entrega\n)\nSELECT * FROM promedio_entrega", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tiempo_promedio_entrega"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.427607Z", "completed_at": "2024-12-20T13:10:20.461361Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.464607Z", "completed_at": "2024-12-20T13:10:20.464648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04309654235839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_avg_revisiones_usuario", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.user_id,\n        AVG(dr.rating) AS calificacion_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    GROUP BY\n        dr.user_id\n),\nusuario_calificacion_promedio AS (\n    SELECT\n        du.user_id,\n        du.first_name,\n        du.last_name,\n        du.email,\n        cp.calificacion_promedio\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users du\n    ON cp.user_id = du.user_id\n)\n\nselect * from usuario_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_avg_revisiones_usuario"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.477853Z", "completed_at": "2024-12-20T13:10:20.503255Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.506351Z", "completed_at": "2024-12-20T13:10:20.506383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03471684455871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_users_info", "compiled": true, "compiled_code": "WITH user_data AS (\n    SELECT \n        u.user_id,\n        u.first_name,\n        u.last_name,\n        u.email,\n        COUNT(DISTINCT o.order_id) AS total_orders,\n        SUM(d.order_total) AS total_spent, -- Ajustado a `dim_orders.order_total`\n        COALESCE(SUM(d.shipping_cost), 0) AS total_shipping_cost, -- Ajustado a `dim_orders.shipping_cost`\n        COALESCE(SUM(d.EUR_discount), 0) AS total_discount,\n        COALESCE(SUM(foi.quantity), 0) AS total_products_bought,\n        COUNT(DISTINCT foi.product_id) AS total_unique_products_bought\n    FROM \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users u\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders o ON u.user_id = o.user_id\n    LEFT JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items foi ON foi.order_id = o.order_id\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders d ON o.order_id = d.order_id -- Agregado para usar columnas de `dim_orders`\n    GROUP BY \n        u.user_id, u.first_name, u.last_name, u.email\n    ORDER BY total_orders DESC\n\n)\n\nSELECT * \nFROM user_data", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_users_info"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.518968Z", "completed_at": "2024-12-20T13:10:20.551517Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.553983Z", "completed_at": "2024-12-20T13:10:20.554017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04131603240966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.avg_revisiones_usuario", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.user_id,\n        AVG(dr.rating) AS calificacion_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.user_id\n),\nusuario_calificacion_promedio AS (\n    SELECT\n        du.user_id,\n        du.first_name,\n        du.last_name,\n        du.email,\n        cp.calificacion_promedio\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users du\n    ON cp.user_id = du.user_id\n)\n\nselect * from usuario_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.avg_revisiones_usuario"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.565481Z", "completed_at": "2024-12-20T13:10:20.591526Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.594707Z", "completed_at": "2024-12-20T13:10:20.594755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03552389144897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.users_info", "compiled": true, "compiled_code": "WITH user_data AS (\n    SELECT \n        u.user_id,\n        u.first_name,\n        u.last_name,\n        u.email,\n        COUNT(DISTINCT o.order_id) AS total_orders,\n        SUM(d.order_total) AS total_spent, -- Ajustado a `dim_orders.order_total`\n        COALESCE(SUM(d.shipping_cost), 0) AS total_shipping_cost, -- Ajustado a `dim_orders.shipping_cost`\n        COALESCE(SUM(d.EUR_discount), 0) AS total_discount,\n        COALESCE(SUM(o.quantity), 0) AS total_products_bought,\n        COUNT(DISTINCT o.product_id) AS total_unique_products_bought\n    FROM \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users u\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders o ON u.user_id = o.user_id\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders d ON o.order_id = d.order_id -- Agregado para usar columnas de `dim_orders`\n    GROUP BY \n        u.user_id, u.first_name, u.last_name, u.email\n    ORDER BY total_orders DESC\n)\n\nSELECT * \nFROM user_data", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.users_info"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.610543Z", "completed_at": "2024-12-20T13:10:20.650714Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.653720Z", "completed_at": "2024-12-20T13:10:20.653767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05160021781921387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.product_snap", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.676012Z", "completed_at": "2024-12-20T13:10:20.761276Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.764804Z", "completed_at": "2024-12-20T13:10:20.764853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09785246849060059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo_snap_product_inventory__0.c980f0342e", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and inventory >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.795214Z", "completed_at": "2024-12-20T13:10:20.839053Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.842364Z", "completed_at": "2024-12-20T13:10:20.842405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056168317794799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo_snap_product_precio__0.3500d1066e", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and precio >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.863658Z", "completed_at": "2024-12-20T13:10:20.901485Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.904701Z", "completed_at": "2024-12-20T13:10:20.904744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.054863929748535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo_snap_product_product_id.c9eef4dcab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.918956Z", "completed_at": "2024-12-20T13:10:20.957213Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:20.962956Z", "completed_at": "2024-12-20T13:10:20.962997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0508427619934082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo_snap_product_product_id.882da776c3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:20.977767Z", "completed_at": "2024-12-20T13:10:21.000845Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.003963Z", "completed_at": "2024-12-20T13:10:21.004006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03270602226257324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.review_snap", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.016913Z", "completed_at": "2024-12-20T13:10:21.052694Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.055571Z", "completed_at": "2024-12-20T13:10:21.055623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04475665092468262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_google_sheets__snap_reviews_comments__1000__0.9968e5e7b1", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        comments\n    ) >= 0 and length(\n        comments\n    ) <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.067164Z", "completed_at": "2024-12-20T13:10:21.096664Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.099955Z", "completed_at": "2024-12-20T13:10:21.099989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038971900939941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__snap_reviews_rating__5__1.ef5838a5f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rating >= 1 and rating <= 5\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.111596Z", "completed_at": "2024-12-20T13:10:21.709657Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.712798Z", "completed_at": "2024-12-20T13:10:21.712846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7278680801391602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_of_type_stg_google_sheets__snap_reviews_created_at__date.5bcf8f6bcc", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('REVIEW_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('USER_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('PRODUCT_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('RATING' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('COMMENTS' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('CREATED_AT' as TEXT) as relation_column,\n            cast('DATE' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('LLEGADA_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'CREATED_AT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.846699Z", "completed_at": "2024-12-20T13:10:21.884803Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.888710Z", "completed_at": "2024-12-20T13:10:21.888758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04826855659484863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__snap_reviews_rating.00ed0522b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.902635Z", "completed_at": "2024-12-20T13:10:21.937682Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.940656Z", "completed_at": "2024-12-20T13:10:21.940696Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04462289810180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.precio_historico", "compiled": true, "compiled_code": "WITH product_history AS (\n\nSELECT\n    ps.product_id,\n    ps.nombre_producto,\n    ps.precio as precio_original,\n    dp.precio as precio_actual,\n    ABS(precio_original - precio_actual) AS price_difference\nFROM ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\nINNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap ps \nON dp.product_id = ps.product_id\nWHERE price_difference > 0\nORDER BY price_difference DESC\n\n)\n\nselect * from product_history", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.precio_historico"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T13:10:21.952220Z", "completed_at": "2024-12-20T13:10:21.976813Z"}, {"name": "execute", "started_at": "2024-12-20T13:10:21.979541Z", "completed_at": "2024-12-20T13:10:21.979573Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03302121162414551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.rating_historico", "compiled": true, "compiled_code": "WITH reviews_snapshot AS (\n    SELECT\n        rs.review_id,\n        rs.product_id,\n        rs.rating AS rating_snapshot,\n        rs.comments AS comments_snapshot\n    FROM ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap rs\n),\n\ncalificacion_promedio_actual AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio_actual,\n        COUNT(dr.rating) AS numero_calificaciones_actuales\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\n\ncalificacion_promedio_historica AS (\n    SELECT\n        rs.product_id,\n        AVG(rs.rating_snapshot) AS calificacion_promedio_historica,\n        COUNT(rs.rating_snapshot) AS numero_calificaciones_historicas\n    FROM\n        reviews_snapshot rs\n    GROUP BY\n        rs.product_id\n),\n\ncomparacion_reviews AS (\n    SELECT\n        ca.product_id,\n        dp.nombre_producto,\n        dp.category,\n        ca.calificacion_promedio_actual,\n        ca.numero_calificaciones_actuales,\n        ch.calificacion_promedio_historica,\n        ch.numero_calificaciones_historicas,\n        ABS(ca.calificacion_promedio_actual - ch.calificacion_promedio_historica) AS diferencia_calificacion_promedio,\n        ca.numero_calificaciones_actuales - ch.numero_calificaciones_historicas AS diferencia_numero_calificaciones\n    FROM\n        calificacion_promedio_actual ca\n    LEFT JOIN\n        calificacion_promedio_historica ch\n    ON\n        ca.product_id = ch.product_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        ca.product_id = dp.product_id\n)\n\nSELECT\n    *\nFROM\n    comparacion_reviews\nWHERE diferencia_calificacion_promedio > 0\nORDER BY\n    diferencia_calificacion_promedio DESC", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.rating_historico"}], "elapsed_time": 14.141098260879517, "args": {"populate_cache": true, "strict_mode": false, "write_json": true, "source_freshness_run_project_hooks": false, "quiet": false, "favor_state": false, "introspect": true, "use_colors": true, "enable_legacy_logger": false, "empty_catalog": false, "static_parser": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "macro_debugging": false, "version_check": true, "log_path": "/mnt/c/Users/juanm/Desktop/DBT/curso_data_engineering/logs", "partial_parse_file_diff": true, "indirect_selection": "eager", "cache_selected_only": false, "invocation_command": "dbt docs generate", "use_colors_file": true, "partial_parse": true, "log_level": "info", "project_dir": "/mnt/c/Users/juanm/Desktop/DBT/curso_data_engineering", "static": false, "exclude": [], "compile": true, "defer": false, "send_anonymous_usage_stats": true, "profiles_dir": "/home/juanma/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "print": true, "require_resource_names_without_spaces": false, "show_resource_report": false, "vars": {}, "which": "generate", "log_file_max_bytes": 10485760, "log_format": "default", "select": [], "printer_width": 80}}