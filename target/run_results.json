{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-12-20T12:29:51.290392Z", "invocation_id": "a7782069-7242-4c05-9300-83f2b022764b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:40.405225Z", "completed_at": "2024-12-20T12:29:40.916320Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:40.918873Z", "completed_at": "2024-12-20T12:29:40.918912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6408112049102783, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.fecha", "compiled": true, "compiled_code": "WITH my_cte AS (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 2557\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        CAST('2019-01-01 00:00:00' AS DATE)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= CAST('2026-01-01 00:00:00' AS DATE)\n\n)\n\nselect * from filtered\n\n\n),\nunioned_dates AS (\n    SELECT \n        date_day,\n        EXTRACT(YEAR FROM date_day) AS year,\n        EXTRACT(MONTH FROM date_day) AS month,\n        EXTRACT(DAY FROM date_day) AS day,\n        EXTRACT(WEEK FROM date_day) AS week,\n        EXTRACT(DOW FROM date_day) AS day_of_week, -- D\u00eda de la semana (0=Lunes, 6=Domingo)\n        EXTRACT(DOY FROM date_day) AS day_of_year, -- D\u00eda del a\u00f1o (1-365 o 1-366 en a\u00f1os bisiestos)\n        EXTRACT(QUARTER FROM date_day) AS quarter,\n        CASE \n            WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN 'Weekend'\n            ELSE 'Weekday'\n        END AS day_type,\n        CASE \n            WHEN EXTRACT(DOW FROM date_day) = 0 THEN 'Monday'\n            WHEN EXTRACT(DOW FROM date_day) = 1 THEN 'Tuesday'\n            WHEN EXTRACT(DOW FROM date_day) = 2 THEN 'Wednesday'\n            WHEN EXTRACT(DOW FROM date_day) = 3 THEN 'Thursday'\n            WHEN EXTRACT(DOW FROM date_day) = 4 THEN 'Friday'\n            WHEN EXTRACT(DOW FROM date_day) = 5 THEN 'Saturday'\n            WHEN EXTRACT(DOW FROM date_day) = 6 THEN 'Sunday'\n        END AS day_name -- Nombre del d\u00eda de la semana\n    FROM my_cte\n\n    UNION ALL\n\n    SELECT \n        CAST('1970-01-01' AS DATE) AS date_day, -- Fecha sin hora\n        1970 AS year, -- A\u00f1o por defecto\n        1 AS month, -- Mes por defecto\n        1 AS day, -- D\u00eda por defecto\n        1 AS week, -- Primera semana del a\u00f1o\n        4 AS day_of_week, -- D\u00eda de la semana (1=Jueves para 1970-01-01)\n        1 AS day_of_year, -- Primer d\u00eda del a\u00f1o\n        1 AS quarter, -- Primer trimestre del a\u00f1o\n        'Unknown' AS day_type, -- Tipo de d\u00eda predeterminado\n        'Thursday' AS day_name -- Nombre del d\u00eda para la fecha 1970-01-01\n)\n\nSELECT *\nFROM unioned_dates", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.052672Z", "completed_at": "2024-12-20T12:29:41.101546Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.104623Z", "completed_at": "2024-12-20T12:29:41.104657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05757308006286621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__budget", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.budget\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(quantity as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as budget_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        quantity::int as quantity,\n        Month(month) as mes,\n        Year(month) as anyo,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\ndeduplicated as (\n    select *,\n        row_number() over (partition by budget_id order by llegada_id desc) as row_num\n    from renamed\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.118463Z", "completed_at": "2024-12-20T12:29:41.152098Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.154768Z", "completed_at": "2024-12-20T12:29:41.154801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04243922233581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__returns", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.returns\n    ),\n\n    renamed as (\n\n        select\n            return_id,\n            order_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            CAST(return_date as date) as return_date,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.167946Z", "completed_at": "2024-12-20T12:29:41.206551Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.209027Z", "completed_at": "2024-12-20T12:29:41.209065Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04721975326538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__reviews", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_BRONZE_DB.google_sheets.reviews\n    ),\n\n    renamed as (\n\n        select\n            review_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n            rating::int as rating,\n            comments,\n            CAST(created_at AS DATE) as created_at,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.221345Z", "completed_at": "2024-12-20T12:29:41.270565Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.273608Z", "completed_at": "2024-12-20T12:29:41.273642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05792093276977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__addresses", "compiled": true, "compiled_code": "\n\nwith \n\n-- 1. Fuente de datos\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.addresses\n),\n\n-- 2. Datos renombrados\nrenamed as (\n    select\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        zipcode,\n        country,\n        address,\n        split_part(address, ' ', 1) as address_number,\n        regexp_substr(address, ' (.*)', 1, 1, 'e', 1) as street,\n        state,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\n-- 3. Direcci\u00f3n predeterminada\nno_addresses as (\n    select distinct\n        md5(cast(coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('no address' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        null as zipcode,\n        'no address' as country,\n        'no address' as address,\n        null as address_number,\n        null as street,\n        null as state,\n        '0' as llegada_id\n),\n\n-- 4. Deduplicaci\u00f3n y manejo de conflictos\ndeduplicated as (\n    select *, \n           row_number() over (partition by address_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_addresses\n    )\n)\n\n-- 5. Selecci\u00f3n final\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.286627Z", "completed_at": "2024-12-20T12:29:41.319251Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.322362Z", "completed_at": "2024-12-20T12:29:41.322398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04181694984436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__category", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * \n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products\n),\n\nrenamed as (\n    select DISTINCT\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        category,\n        _DLT_LOAD_ID as llegada_id\n    from source\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.333578Z", "completed_at": "2024-12-20T12:29:41.373008Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.376174Z", "completed_at": "2024-12-20T12:29:41.376211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04807567596435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__event_type", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.events\n),\n\nrenamed as (\n    select\n        event_type,\n        md5(cast(coalesce(cast(event_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_type_id,\n        _DLT_LOAD_ID as llegada_id\n    from source\n    group by event_type, _DLT_LOAD_ID\n)\n\nselect * from renamed\n\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.389159Z", "completed_at": "2024-12-20T12:29:41.425807Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.428815Z", "completed_at": "2024-12-20T12:29:41.428852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04624223709106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__events", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.events\n\n),\n\nrenamed as (\n\n    select\n        event_id,\n        page_url,\n        -- Extraer el dominio de la URL\n        regexp_substr(page_url, '^(https?://[^/]+)') as domain,\n        -- Extraer el ID \u00fanico de la URL\n        regexp_substr(page_url, '[^/]+$', 1, 1) as page_id,\n        md5(cast(coalesce(cast(event_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_type_id,\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,   \n        session_id,\n        CAST(created_at AS DATE) as created_at,\n        _DLT_LOAD_ID as llegada_id\n\n    from source\n\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.440451Z", "completed_at": "2024-12-20T12:29:41.469259Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.471598Z", "completed_at": "2024-12-20T12:29:41.471632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036695241928100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__order_items", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.order_items\n\n),\n\nrenamed as (\n\n    select\n        md5(cast(coalesce(cast(order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_items_id,\n        order_id,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        quantity,\n        _DLT_LOAD_ID as llegada_id\n\n    from source\n\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.481836Z", "completed_at": "2024-12-20T12:29:41.514862Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.517194Z", "completed_at": "2024-12-20T12:29:41.517228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04028058052062988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        order_id,\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        shipping_cost,\n        CAST(created_at AS DATE) as created_at,\n        CAST(estimated_delivery_at AS DATE) as estimated_delivery_at,\n        order_cost,\n        order_total,\n        CAST(delivered_at AS DATE) as delivered_at,\n        tracking_id,\n        md5(cast(coalesce(cast(shipping_service as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as shipping_service_id,\n        md5(cast(coalesce(cast(promo_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        md5(cast(coalesce(cast(status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as status_id,\n        _DLT_LOAD_ID as llegada_id\n    from source \n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.528259Z", "completed_at": "2024-12-20T12:29:41.556996Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.559752Z", "completed_at": "2024-12-20T12:29:41.559785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037105560302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        price::decimal(10, 2) as precio,\n        name as nombre_producto,\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        inventory,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\nno_products as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        0 as precio,\n        'no products' as nombre_producto,\n        md5(cast(coalesce(cast('no products' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        0 as inventory,\n        '0' as llegada_id\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by product_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_products\n    )\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.570482Z", "completed_at": "2024-12-20T12:29:41.598238Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.601574Z", "completed_at": "2024-12-20T12:29:41.601610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03630185127258301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__promos", "compiled": true, "compiled_code": "\n\nwith \n\n-- 1. Fuente de datos\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.promos\n),\n\n-- 2. Datos renombrados\nrenamed as (\n    select\n        md5(cast(coalesce(cast(promo_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        promo_id as name,\n        discount as EUR_discount,\n        status,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\n-- 3. Promos predeterminadas\nno_promos as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as promo_id,\n        'no promo' as name,\n        null as EUR_discount,\n        null as status,\n        '0' as llegada_id\n),\n\n-- 4. Deduplicaci\u00f3n y manejo de conflictos\ndeduplicated as (\n    select *, \n           row_number() over (partition by promo_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_promos\n    )\n)\n\n-- 5. Selecci\u00f3n final\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.614960Z", "completed_at": "2024-12-20T12:29:41.651364Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.654414Z", "completed_at": "2024-12-20T12:29:41.654456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04743242263793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__shipping_service", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(shipping_service as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as shipping_service_id,\n        shipping_service,\n        _DLT_LOAD_ID as llegada_id\n    from source\n)\n\nselect distinct * from renamed\n\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.666067Z", "completed_at": "2024-12-20T12:29:41.694455Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.696881Z", "completed_at": "2024-12-20T12:29:41.696912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03588557243347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__status", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.orders\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as status_id,\n        status,\n        _DLT_LOAD_ID as llegada_id\n    from source\n)\n\nselect distinct * from renamed\n\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status)\n\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.707784Z", "completed_at": "2024-12-20T12:29:41.741859Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.744645Z", "completed_at": "2024-12-20T12:29:41.744680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04219222068786621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo__users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.users\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n        CAST(updated_at AS DATE) as updated_at,\n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(state as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as address_id,\n        last_name,\n        CAST(created_at AS DATE) as created_at,\n        phone_number,\n        first_name,\n        email,\n        _DLT_LOAD_ID as llegada_id\n    from source\n)\n\nselect * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.756749Z", "completed_at": "2024-12-20T12:29:41.761034Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.763321Z", "completed_at": "2024-12-20T12:29:41.763352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011819601058959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.Proyecto_final.personas", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.773127Z", "completed_at": "2024-12-20T12:29:41.784396Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.786777Z", "completed_at": "2024-12-20T12:29:41.786811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018535137176513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Proyecto_final.products_snapshot", "compiled": true, "compiled_code": "\n\n\n\nWITH deduplicated_products AS (\n    SELECT \n        *,\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS product_id,\n        ROW_NUMBER() OVER (PARTITION BY md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) ORDER BY _DLT_LOAD_ID DESC) AS row_num\n    FROM ALUMNO11_PRO_BRONZE_DB.sql_server_dbo.products p\n)\nSELECT *\nFROM deduplicated_products\nWHERE row_num = 1\n", "relation_name": "ALUMNO11_PRO_GOLD_DB.snapshots.products_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.796796Z", "completed_at": "2024-12-20T12:29:41.805347Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.807800Z", "completed_at": "2024-12-20T12:29:41.807836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015892744064331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Proyecto_final.reviews_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect *\nfrom ALUMNO11_PRO_BRONZE_DB.google_sheets.reviews r\n", "relation_name": "ALUMNO11_PRO_GOLD_DB.snapshots.reviews_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.818042Z", "completed_at": "2024-12-20T12:29:41.861293Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.863836Z", "completed_at": "2024-12-20T12:29:41.863871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05095362663269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_fecha", "compiled": true, "compiled_code": "with \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha\n),\n\nrenamed as (\n    select\n        date_day,\n        year,\n        month,\n        day,\n        week,\n        day_of_week,\n        day_of_year,\n        quarter,\n        day_type,\n        day_name\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.878122Z", "completed_at": "2024-12-20T12:29:41.929992Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.933129Z", "completed_at": "2024-12-20T12:29:41.933176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0622410774230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_fecha", "compiled": true, "compiled_code": "with \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.fecha\n),\n\nrenamed as (\n    select\n        date_day,\n        year,\n        month,\n        day,\n        week,\n        day_of_week,\n        day_of_year,\n        quarter,\n        day_type,\n        day_name\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.946614Z", "completed_at": "2024-12-20T12:29:41.976297Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:41.979372Z", "completed_at": "2024-12-20T12:29:41.979416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038958072662353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_budget", "compiled": true, "compiled_code": "\n\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_budget)\n    \n),\n\nrenamed as (\n    select\n        budget_id,\n        product_id,\n        quantity,\n        mes,\n        anyo,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:41.993467Z", "completed_at": "2024-12-20T12:29:42.186832Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.190148Z", "completed_at": "2024-12-20T12:29:42.190194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2036902904510498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_budget", "compiled": true, "compiled_code": "\n\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_budget)\n    \n),\n\nrenamed as (\n    select\n        budget_id,\n        product_id,\n        quantity,\n        mes,\n        anyo,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_budget"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.205178Z", "completed_at": "2024-12-20T12:29:42.300762Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.309844Z", "completed_at": "2024-12-20T12:29:42.309894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11304450035095215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_anyo__2020.5dd1c26236", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and anyo >= 2020\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.345558Z", "completed_at": "2024-12-20T12:29:42.444282Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.456585Z", "completed_at": "2024-12-20T12:29:42.456633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12912964820861816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_mes__12__1.f1d664fde9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mes >= 1 and mes <= 12\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.483231Z", "completed_at": "2024-12-20T12:29:42.536746Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.541536Z", "completed_at": "2024-12-20T12:29:42.541582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06876063346862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__budget_quantity__0.fc16210298", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and quantity >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.561654Z", "completed_at": "2024-12-20T12:29:42.651563Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.655615Z", "completed_at": "2024-12-20T12:29:42.655680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10658764839172363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_budget_id.006b549f1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect budget_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere budget_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.675625Z", "completed_at": "2024-12-20T12:29:42.713519Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.718140Z", "completed_at": "2024-12-20T12:29:42.718188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05058431625366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_llegada_id.bfcc3f4f74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.733943Z", "completed_at": "2024-12-20T12:29:42.758615Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.761888Z", "completed_at": "2024-12-20T12:29:42.761921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03538942337036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_product_id.28900fc726", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.772626Z", "completed_at": "2024-12-20T12:29:42.795948Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.798491Z", "completed_at": "2024-12-20T12:29:42.798533Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03163909912109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__budget_quantity.f478215981", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.809331Z", "completed_at": "2024-12-20T12:29:42.838284Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.840746Z", "completed_at": "2024-12-20T12:29:42.840779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03662467002868652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__budget_budget_id.e286deef8f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    budget_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\nwhere budget_id is not null\ngroup by budget_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.849409Z", "completed_at": "2024-12-20T12:29:42.873072Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.875387Z", "completed_at": "2024-12-20T12:29:42.875423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0302584171295166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_returns", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns)\n    \n),\n\nrenamed as (\n    select\n        return_id,\n        order_id,\n        user_id,\n        return_date,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.886251Z", "completed_at": "2024-12-20T12:29:42.914051Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.916270Z", "completed_at": "2024-12-20T12:29:42.916302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035318851470947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_returns", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns)\n    \n),\n\nrenamed as (\n    select\n        return_id,\n        order_id,\n        user_id,\n        return_date,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.924956Z", "completed_at": "2024-12-20T12:29:42.947380Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.950684Z", "completed_at": "2024-12-20T12:29:42.950728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030042648315429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_llegada_id.d9f1b870aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:42.962244Z", "completed_at": "2024-12-20T12:29:42.993791Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:42.996128Z", "completed_at": "2024-12-20T12:29:42.996174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039392948150634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_order_id.e9c5a88a22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.008048Z", "completed_at": "2024-12-20T12:29:43.041183Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.044997Z", "completed_at": "2024-12-20T12:29:43.045043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.042676448822021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_return_id.6f354a4368", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect return_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere return_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.056767Z", "completed_at": "2024-12-20T12:29:43.080667Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.083526Z", "completed_at": "2024-12-20T12:29:43.083581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03182649612426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__returns_user_id.3eaae3618f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.095211Z", "completed_at": "2024-12-20T12:29:43.122430Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.124613Z", "completed_at": "2024-12-20T12:29:43.124655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03512382507324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__returns_return_id.771f63cf6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    return_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\nwhere return_id is not null\ngroup by return_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.137035Z", "completed_at": "2024-12-20T12:29:43.171263Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.174182Z", "completed_at": "2024-12-20T12:29:43.174233Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04382443428039551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_reviews", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.186868Z", "completed_at": "2024-12-20T12:29:43.215506Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.218601Z", "completed_at": "2024-12-20T12:29:43.218646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03790640830993652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_reviews", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.232040Z", "completed_at": "2024-12-20T12:29:43.265015Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.268362Z", "completed_at": "2024-12-20T12:29:43.268461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04340863227844238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_google_sheets__reviews_comments__1000__0.2020d01378", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        comments\n    ) >= 0 and length(\n        comments\n    ) <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.282612Z", "completed_at": "2024-12-20T12:29:43.317679Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.320678Z", "completed_at": "2024-12-20T12:29:43.320712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04457497596740723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__reviews_rating__5__1.ca1b68bf35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rating >= 1 and rating <= 5\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:43.333987Z", "completed_at": "2024-12-20T12:29:43.889262Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:43.892007Z", "completed_at": "2024-12-20T12:29:43.892043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.76249098777771, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_of_type_stg_google_sheets__reviews_created_at__date.002c48ad3e", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('REVIEW_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('USER_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('PRODUCT_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('RATING' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('COMMENTS' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('CREATED_AT' as TEXT) as relation_column,\n            cast('DATE' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('LLEGADA_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'CREATED_AT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.102676Z", "completed_at": "2024-12-20T12:29:44.138782Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.141418Z", "completed_at": "2024-12-20T12:29:44.141452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044699668884277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_llegada_id.a4171fb8d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.152904Z", "completed_at": "2024-12-20T12:29:44.189111Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.192202Z", "completed_at": "2024-12-20T12:29:44.192255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04513263702392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_product_id.90cbd73bfe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.203776Z", "completed_at": "2024-12-20T12:29:44.230830Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.233226Z", "completed_at": "2024-12-20T12:29:44.233260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034644126892089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_rating.e7c187076c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.242691Z", "completed_at": "2024-12-20T12:29:44.274463Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.276708Z", "completed_at": "2024-12-20T12:29:44.276745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038838863372802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_review_id.e0ebed4e17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere review_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.287072Z", "completed_at": "2024-12-20T12:29:44.321817Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.324880Z", "completed_at": "2024-12-20T12:29:44.324913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.042760372161865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__reviews_user_id.848490bd4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.335992Z", "completed_at": "2024-12-20T12:29:44.364226Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.366822Z", "completed_at": "2024-12-20T12:29:44.366853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03646397590637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_google_sheets__reviews_review_id.60a9384c9d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\nwhere review_id is not null\ngroup by review_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.377054Z", "completed_at": "2024-12-20T12:29:44.402886Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.405974Z", "completed_at": "2024-12-20T12:29:44.406021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03450798988342285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_addresses", "compiled": true, "compiled_code": "\n\nwith \nsource as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_addresses) -- Solo datos nuevos o actualizados\n    \n),\n\nrenamed as (\n    select\n        address_id,\n        zipcode,\n        country,\n        address,\n        street,\n        address_number,\n        state,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.419970Z", "completed_at": "2024-12-20T12:29:44.451933Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.455201Z", "completed_at": "2024-12-20T12:29:44.455249Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0428309440612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_addresses", "compiled": true, "compiled_code": "\n\nwith \nsource as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses) -- Solo datos nuevos o actualizados\n    \n),\n\nrenamed as (\n    select\n        address_id,\n        zipcode,\n        country,\n        address,\n        street,\n        address_number,\n        state,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.468595Z", "completed_at": "2024-12-20T12:29:44.519878Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.522573Z", "completed_at": "2024-12-20T12:29:44.522612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06039857864379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__addresses_zipcode__10__5.0cf4a94b2e", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        zipcode\n    ) >= 5 and length(\n        zipcode\n    ) <= 10\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.535396Z", "completed_at": "2024-12-20T12:29:44.566063Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.568399Z", "completed_at": "2024-12-20T12:29:44.568434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039846181869506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__addresses_address_id.7adfa006d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\nwhere address_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.578401Z", "completed_at": "2024-12-20T12:29:44.606043Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.608291Z", "completed_at": "2024-12-20T12:29:44.608324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034807682037353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__addresses_address_id.94c6a3ff03", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    address_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\nwhere address_id is not null\ngroup by address_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.617814Z", "completed_at": "2024-12-20T12:29:44.641981Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.645166Z", "completed_at": "2024-12-20T12:29:44.645210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032213449478149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__category_category_id.7a677dd73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category\nwhere category_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.658462Z", "completed_at": "2024-12-20T12:29:44.686916Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.691596Z", "completed_at": "2024-12-20T12:29:44.691642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04011654853820801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__category_category_id.b5113ca33e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    category_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category\nwhere category_id is not null\ngroup by category_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.709380Z", "completed_at": "2024-12-20T12:29:44.737960Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.741250Z", "completed_at": "2024-12-20T12:29:44.741293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04238629341125488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__event_type_event_type_id.29d222ff42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\nwhere event_type_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.755311Z", "completed_at": "2024-12-20T12:29:44.790002Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.792869Z", "completed_at": "2024-12-20T12:29:44.792912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0438082218170166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__event_type_event_type_id.5dd5d67bfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_type_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\nwhere event_type_id is not null\ngroup by event_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.804882Z", "completed_at": "2024-12-20T12:29:44.832621Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.835747Z", "completed_at": "2024-12-20T12:29:44.835792Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037821054458618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_events", "compiled": true, "compiled_code": "\n\nwith \n\nfiltered_events as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events)\n    \n),\n\nsource as (\n    select\n        e.event_id,\n        e.page_url,\n        t.event_type,\n        e.user_id,\n        e.product_id,\n        e.session_id,\n        e.created_at,\n        e.llegada_id\n    from \n        filtered_events e\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type t \n        on e.event_type_id = t.event_type_id\n),\n\nrenamed as (\n    select\n        event_id,\n        page_url,\n        event_type,\n        user_id,\n        product_id,\n        session_id,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.848269Z", "completed_at": "2024-12-20T12:29:44.873541Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.876009Z", "completed_at": "2024-12-20T12:29:44.876048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03233647346496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.facts_events", "compiled": true, "compiled_code": "\n\nwith \n\nfiltered_events as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events)\n    \n),\n\nsource as (\n    select\n        e.event_id,\n        e.page_url,\n        t.event_type,\n        e.user_id,\n        e.product_id,\n        e.session_id,\n        e.created_at,\n        e.llegada_id\n    from \n        filtered_events e\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type t \n        on e.event_type_id = t.event_type_id\n),\n\nrenamed as (\n    select\n        event_id,\n        page_url,\n        event_type,\n        user_id,\n        product_id,\n        session_id,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.887830Z", "completed_at": "2024-12-20T12:29:44.917482Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.920262Z", "completed_at": "2024-12-20T12:29:44.920292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03847002983093262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_match_regex_stg_sql_server_dbo__events_page_url___http_https_.6e0a9d7f44", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(page_url, '^(http|https)://', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.930025Z", "completed_at": "2024-12-20T12:29:44.956312Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:44.959300Z", "completed_at": "2024-12-20T12:29:44.959371Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034560441970825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_created_at.7da8ed3123", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:44.977448Z", "completed_at": "2024-12-20T12:29:45.008909Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.012345Z", "completed_at": "2024-12-20T12:29:45.012380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.042688608169555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_event_id.fec0cbfc6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.033776Z", "completed_at": "2024-12-20T12:29:45.113007Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.121868Z", "completed_at": "2024-12-20T12:29:45.121916Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10355639457702637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_llegada_id.b84f693b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.143472Z", "completed_at": "2024-12-20T12:29:45.199324Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.202031Z", "completed_at": "2024-12-20T12:29:45.202103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06692171096801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__events_session_id.87ef1f5f17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.214656Z", "completed_at": "2024-12-20T12:29:45.251150Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.254164Z", "completed_at": "2024-12-20T12:29:45.254210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04557490348815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_event_type_id__event_type_id__ref_stg_sql_server_dbo__event_type_.03e592b922", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select event_type_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where event_type_id is not null\n),\n\nparent as (\n    select event_type_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__event_type\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.267210Z", "completed_at": "2024-12-20T12:29:45.310342Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.313360Z", "completed_at": "2024-12-20T12:29:45.313416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052509307861328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__events_event_id.8f149a4f3b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.331569Z", "completed_at": "2024-12-20T12:29:45.366693Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.369864Z", "completed_at": "2024-12-20T12:29:45.369900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048514604568481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_order_items", "compiled": true, "compiled_code": "\n\nwith \n\nsource_order_items as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items)\n    \n),\n\nfacts_order_items as (\n    select\n        order_items_id,\n        order_id,\n        product_id,\n        quantity,\n        llegada_id\n    from source_order_items  \n)\n\nselect * from facts_order_items", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.382903Z", "completed_at": "2024-12-20T12:29:45.412102Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.415076Z", "completed_at": "2024-12-20T12:29:45.415119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038427114486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__order_items_quantity__0.edf134e029", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and quantity >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.427714Z", "completed_at": "2024-12-20T12:29:45.456137Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.458467Z", "completed_at": "2024-12-20T12:29:45.458500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03690457344055176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__order_items_order_items_id.000301c747", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_items_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\nwhere order_items_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.469066Z", "completed_at": "2024-12-20T12:29:45.499879Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.502110Z", "completed_at": "2024-12-20T12:29:45.502142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038069963455200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__order_items_order_items_id.4009fa6f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_items_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\nwhere order_items_id is not null\ngroup by order_items_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.511668Z", "completed_at": "2024-12-20T12:29:45.537074Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.540650Z", "completed_at": "2024-12-20T12:29:45.540701Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03396177291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_facts_orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource_orders as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders)\n    \n),\n\nfacts_orders as (\n    select\n        order_id,\n        address_id,\n        user_id,\n        llegada_id\n    from source_orders\n)\n\nselect * from facts_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.556593Z", "completed_at": "2024-12-20T12:29:45.592711Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.595151Z", "completed_at": "2024-12-20T12:29:45.595187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04610848426818848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.facts_orders", "compiled": true, "compiled_code": "\n\nwith \n\nsource_orders as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders)\n    \n),\n\nsource_order_items as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders)\n    \n),\n\nfacts_orders as (\n    select\n        o.order_id,\n        o.address_id,\n        o.user_id,\n        oi.order_items_id,\n        oi.product_id,\n        oi.quantity,\n        oi.llegada_id\n    from source_orders o\n    join source_order_items oi on o.order_id = oi.order_id\n)\n\nselect * from facts_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.608335Z", "completed_at": "2024-12-20T12:29:45.642830Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.645872Z", "completed_at": "2024-12-20T12:29:45.645907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.045059919357299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__orders_shipping_cost__500__0.9a53dc7b86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and shipping_cost >= 0 and shipping_cost <= 500\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.657496Z", "completed_at": "2024-12-20T12:29:45.683980Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.687105Z", "completed_at": "2024-12-20T12:29:45.687141Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03521728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_created_at.aa4aed5a27", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.698970Z", "completed_at": "2024-12-20T12:29:45.727783Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.730752Z", "completed_at": "2024-12-20T12:29:45.730803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03805184364318848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_llegada_id.949da46a97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.744519Z", "completed_at": "2024-12-20T12:29:45.803974Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.807063Z", "completed_at": "2024-12-20T12:29:45.807109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06997513771057129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__orders_order_id.25a1d355bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.823484Z", "completed_at": "2024-12-20T12:29:45.870001Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.873908Z", "completed_at": "2024-12-20T12:29:45.873955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05954313278198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__returns_order_id__order_id__ref_stg_sql_server_dbo__orders_.88c9677bc8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.895019Z", "completed_at": "2024-12-20T12:29:45.943105Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:45.946379Z", "completed_at": "2024-12-20T12:29:45.946426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06037712097167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__order_items_order_id__order_id__ref_stg_sql_server_dbo__orders_.72cfa1d8f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:45.961085Z", "completed_at": "2024-12-20T12:29:46.003797Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.009805Z", "completed_at": "2024-12-20T12:29:46.009853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056029319763183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_address_id__address_id__ref_stg_sql_server_dbo__addresses_.7b49372150", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select address_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where address_id is not null\n),\n\nparent as (\n    select address_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.031388Z", "completed_at": "2024-12-20T12:29:46.070978Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.075285Z", "completed_at": "2024-12-20T12:29:46.075331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05784964561462402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__orders_order_id.80c9c7c401", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.131866Z", "completed_at": "2024-12-20T12:29:46.194375Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.200858Z", "completed_at": "2024-12-20T12:29:46.200913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11487483978271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.223436Z", "completed_at": "2024-12-20T12:29:46.279500Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.282458Z", "completed_at": "2024-12-20T12:29:46.282505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06851696968078613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_products", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.300002Z", "completed_at": "2024-12-20T12:29:46.335291Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.338435Z", "completed_at": "2024-12-20T12:29:46.338468Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04763603210449219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__products_inventory__0.d8fc322441", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and inventory >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.351455Z", "completed_at": "2024-12-20T12:29:46.385424Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.390867Z", "completed_at": "2024-12-20T12:29:46.390917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046561241149902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__products_precio__0.91d0218749", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and precio >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.406782Z", "completed_at": "2024-12-20T12:29:46.436086Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.438750Z", "completed_at": "2024-12-20T12:29:46.438823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03995490074157715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__products_product_id.fcbd02a208", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.448696Z", "completed_at": "2024-12-20T12:29:46.475030Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.477608Z", "completed_at": "2024-12-20T12:29:46.477642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033539533615112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__budget_product_id__product_id__ref_stg_sql_server_dbo__products_.22dde86a0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__budget\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.487063Z", "completed_at": "2024-12-20T12:29:46.513404Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.516171Z", "completed_at": "2024-12-20T12:29:46.516214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03383374214172363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__reviews_product_id__product_id__ref_stg_sql_server_dbo__products_.c7fd681407", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.528696Z", "completed_at": "2024-12-20T12:29:46.564524Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.567029Z", "completed_at": "2024-12-20T12:29:46.567067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04439806938171387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_product_id__product_id__ref_stg_sql_server_dbo__products_.6175065fb0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.579708Z", "completed_at": "2024-12-20T12:29:46.609746Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.612329Z", "completed_at": "2024-12-20T12:29:46.612363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0390627384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__order_items_product_id__product_id__ref_stg_sql_server_dbo__products_.9298c4739b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__order_items\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.623744Z", "completed_at": "2024-12-20T12:29:46.651264Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.653852Z", "completed_at": "2024-12-20T12:29:46.653888Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03485393524169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__products_product_id.64430c143e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.664301Z", "completed_at": "2024-12-20T12:29:46.692171Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.695060Z", "completed_at": "2024-12-20T12:29:46.695100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03609132766723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo__promos_EUR_discount__1000__0.f800ea0cfd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and EUR_discount >= 0 and EUR_discount <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.707073Z", "completed_at": "2024-12-20T12:29:46.733080Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.735590Z", "completed_at": "2024-12-20T12:29:46.735624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0341343879699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__promos_promo_id.ef15ef851e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect promo_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\nwhere promo_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.745209Z", "completed_at": "2024-12-20T12:29:46.781646Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.784713Z", "completed_at": "2024-12-20T12:29:46.784763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04446005821228027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_promo_id__promo_id__ref_stg_sql_server_dbo__promos_.844e202eae", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select promo_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where promo_id is not null\n),\n\nparent as (\n    select promo_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.805088Z", "completed_at": "2024-12-20T12:29:46.840429Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.843565Z", "completed_at": "2024-12-20T12:29:46.843621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04851722717285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__promos_promo_id.7dc1b5a0df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    promo_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos\nwhere promo_id is not null\ngroup by promo_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.858560Z", "completed_at": "2024-12-20T12:29:46.895052Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.897775Z", "completed_at": "2024-12-20T12:29:46.897817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046454429626464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__shipping_service_shipping_service_id.6100e89129", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shipping_service_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\nwhere shipping_service_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.915328Z", "completed_at": "2024-12-20T12:29:46.951322Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:46.953967Z", "completed_at": "2024-12-20T12:29:46.954016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04980802536010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_shipping_service_id__shipping_service_id__ref_stg_sql_server_dbo__shipping_service_.243663b109", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select shipping_service_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where shipping_service_id is not null\n),\n\nparent as (\n    select shipping_service_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:46.969417Z", "completed_at": "2024-12-20T12:29:47.003857Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.007075Z", "completed_at": "2024-12-20T12:29:47.007123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044907569885253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__shipping_service_shipping_service_id.e659a814a9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    shipping_service_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service\nwhere shipping_service_id is not null\ngroup by shipping_service_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.019675Z", "completed_at": "2024-12-20T12:29:47.043660Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.045910Z", "completed_at": "2024-12-20T12:29:47.045942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03317451477050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_orders", "compiled": true, "compiled_code": "\n\nwith \n\n-- Filtra datos incrementales antes de las uniones\nfiltered_orders as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders)\n    \n),\n\n-- Construye la dimension combinando con otras tablas\ndim_orders as (\n    select\n        o.order_id,\n        s.shipping_service,\n        o.shipping_cost,\n        o.created_at,\n        o.estimated_delivery_at,\n        p.name as nombre_promocion,\n        p.EUR_discount,\n        p.status as promo_estado,\n        st.status as order_status,\n        o.order_cost,\n        o.order_total,\n        o.delivered_at,\n        o.tracking_id,\n        o.llegada_id\n    from \n        filtered_orders o\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos p on o.promo_id = p.promo_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service s on o.shipping_service_id = s.shipping_service_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status st on o.status_id = st.status_id\n)\n\nselect * from dim_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.057581Z", "completed_at": "2024-12-20T12:29:47.082604Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.084818Z", "completed_at": "2024-12-20T12:29:47.084851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033501625061035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_orders", "compiled": true, "compiled_code": "\n\nwith \n\n-- Filtra datos incrementales antes de las uniones\nfiltered_orders as (\n    select * \n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders)\n    \n),\n\n-- Construye la dimension combinando con otras tablas\ndim_orders as (\n    select\n        o.order_id,\n        s.shipping_service,\n        o.shipping_cost,\n        o.created_at,\n        o.estimated_delivery_at,\n        p.name as nombre_promocion,\n        p.EUR_discount,\n        p.status as promo_estado,\n        st.status as order_status,\n        o.order_cost,\n        o.order_total,\n        o.delivered_at,\n        o.tracking_id,\n        o.llegada_id\n    from \n        filtered_orders o\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__promos p on o.promo_id = p.promo_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__shipping_service s on o.shipping_service_id = s.shipping_service_id\n    left join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status st on o.status_id = st.status_id\n)\n\nselect * from dim_orders", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.094849Z", "completed_at": "2024-12-20T12:29:47.121117Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.123724Z", "completed_at": "2024-12-20T12:29:47.123755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03375649452209473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_in_set_stg_sql_server_dbo__status_status__preparing__delivered__shipped.17dbd2f562", "compiled": true, "compiled_code": "\n\nwith all_values as (\n\n    select\n        status as value_field\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\n    \n\n),\nset_values as (\n\n    select\n        cast('preparing' as TEXT) as value_field\n    union all\n    select\n        cast('delivered' as TEXT) as value_field\n    union all\n    select\n        cast('shipped' as TEXT) as value_field\n    \n    \n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        v.value_field\n    from\n        all_values v\n        left join\n        set_values s on v.value_field = s.value_field\n    where\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.133139Z", "completed_at": "2024-12-20T12:29:47.160885Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.163102Z", "completed_at": "2024-12-20T12:29:47.163135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03461265563964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__status_status_id.3ccf2cdfcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\nwhere status_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.172863Z", "completed_at": "2024-12-20T12:29:47.199489Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.202601Z", "completed_at": "2024-12-20T12:29:47.202644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03496146202087402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_status_id__status_id__ref_stg_sql_server_dbo__status_.f79d37ea89", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select status_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where status_id is not null\n),\n\nparent as (\n    select status_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.214376Z", "completed_at": "2024-12-20T12:29:47.239326Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.241983Z", "completed_at": "2024-12-20T12:29:47.242017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03272223472595215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__status_status_id.dceb04c7ab", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    status_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__status\nwhere status_id is not null\ngroup by status_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.251336Z", "completed_at": "2024-12-20T12:29:47.274032Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.276417Z", "completed_at": "2024-12-20T12:29:47.276450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02965378761291504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_dim_users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users)\n    \n),\n\nrenamed as (\n    select\n        user_id,\n        updated_at,\n        address_id,\n        last_name,\n        created_at,\n        phone_number,\n        first_name,\n        email,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.287313Z", "completed_at": "2024-12-20T12:29:47.313438Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.315976Z", "completed_at": "2024-12-20T12:29:47.316026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03345012664794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.dim_users", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users)\n    \n),\n\nrenamed as (\n    select\n        user_id,\n        updated_at,\n        address_id,\n        last_name,\n        created_at,\n        phone_number,\n        first_name,\n        email,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.327026Z", "completed_at": "2024-12-20T12:29:47.352071Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.354456Z", "completed_at": "2024-12-20T12:29:47.354492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03210783004760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__users_first_name__50__1.94fa964027", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        first_name\n    ) >= 1 and length(\n        first_name\n    ) <= 50\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.367493Z", "completed_at": "2024-12-20T12:29:47.399802Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.402773Z", "completed_at": "2024-12-20T12:29:47.402822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04313182830810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_sql_server_dbo__users_last_name__50__1.b6d1936e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        last_name\n    ) >= 1 and length(\n        last_name\n    ) <= 50\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.415553Z", "completed_at": "2024-12-20T12:29:47.442585Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.445685Z", "completed_at": "2024-12-20T12:29:47.445729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03628182411193848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_match_regex_stg_sql_server_dbo__users_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.323eecfc64", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(email, '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.456914Z", "completed_at": "2024-12-20T12:29:47.486448Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.489384Z", "completed_at": "2024-12-20T12:29:47.489419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037566184997558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_created_at.188683f156", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.501644Z", "completed_at": "2024-12-20T12:29:47.527293Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.530062Z", "completed_at": "2024-12-20T12:29:47.530104Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03555488586425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_llegada_id.f27d0e2381", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect llegada_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere llegada_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.542146Z", "completed_at": "2024-12-20T12:29:47.566544Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.570540Z", "completed_at": "2024-12-20T12:29:47.570591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03429841995239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_updated_at.e4ba690261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.592248Z", "completed_at": "2024-12-20T12:29:47.632081Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.635266Z", "completed_at": "2024-12-20T12:29:47.635313Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0504755973815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo__users_user_id.0bc26a926a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.649315Z", "completed_at": "2024-12-20T12:29:47.684751Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.687936Z", "completed_at": "2024-12-20T12:29:47.687982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04571366310119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__returns_user_id__user_id__ref_stg_sql_server_dbo__users_.33205d9195", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__returns\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.701940Z", "completed_at": "2024-12-20T12:29:47.737088Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.739821Z", "completed_at": "2024-12-20T12:29:47.739866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044583797454833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_google_sheets__reviews_user_id__user_id__ref_stg_sql_server_dbo__users_.aec5e65c76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__reviews\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.753328Z", "completed_at": "2024-12-20T12:29:47.787794Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.790880Z", "completed_at": "2024-12-20T12:29:47.790928Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04381895065307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__events_user_id__user_id__ref_stg_sql_server_dbo__users_.345bb30f84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__events\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.805632Z", "completed_at": "2024-12-20T12:29:47.834472Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.837388Z", "completed_at": "2024-12-20T12:29:47.837435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0389246940612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__orders_user_id__user_id__ref_stg_sql_server_dbo__users_.78d51ec636", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__orders\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.850485Z", "completed_at": "2024-12-20T12:29:47.884369Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.887594Z", "completed_at": "2024-12-20T12:29:47.887645Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.043287038803100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.relationships_stg_sql_server_dbo__users_address_id__address_id__ref_stg_sql_server_dbo__addresses_.256c72b0e6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select address_id as from_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\n    where address_id is not null\n),\n\nparent as (\n    select address_id as to_field\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__addresses\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.901384Z", "completed_at": "2024-12-20T12:29:47.928606Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.930921Z", "completed_at": "2024-12-20T12:29:47.930956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03535962104797363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo__users_user_id.5dc7e3213c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__users\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.942000Z", "completed_at": "2024-12-20T12:29:47.972322Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:47.974802Z", "completed_at": "2024-12-20T12:29:47.974836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038108110427856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_sql_server_dbo_snap_product", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select distinct *\n    from ALUMNO11_PRO_GOLD_DB.snapshots.products_snapshot\n),\n\nrenamed as (\n    select\n        md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        price::decimal(10, 2) as precio,\n        name as nombre_producto,\n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        inventory,\n        _DLT_LOAD_ID as llegada_id\n    from source\n),\n\nno_products as (\n    select distinct\n        md5(cast(coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(null as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        0 as precio,\n        'no products' as nombre_producto,\n        md5(cast(coalesce(cast('no products' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as category_id,\n        0 as inventory,\n        '0' as llegada_id\n),\n\ndeduplicated as (\n    select *, \n           row_number() over (partition by product_id order by llegada_id desc) as row_num\n    from (\n        select * from renamed\n        union all\n        select * from no_products\n    )\n)\n\nselect *\nfrom deduplicated\nwhere row_num = 1\n\n\nand llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:47.986883Z", "completed_at": "2024-12-20T12:29:48.019788Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.022786Z", "completed_at": "2024-12-20T12:29:48.022820Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.041821956634521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.stg_google_sheets__snap_reviews", "compiled": true, "compiled_code": "\n\nwith\n\n    source as (\n        select * from ALUMNO11_PRO_GOLD_DB.snapshots.reviews_snapshot\n    ),\n\n    renamed as (\n\n        select\n            review_id,\n            md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as user_id,\n            md5(cast(coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n            rating::int as rating,\n            comments,\n            CAST(created_at AS DATE) as created_at,\n            _DLT_LOAD_ID as llegada_id\n        from source\n\n    )\n\n    select * from renamed\n\n\nwhere llegada_id > (select max(llegada_id) from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews)\n", "relation_name": "ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.033602Z", "completed_at": "2024-12-20T12:29:48.069312Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.071924Z", "completed_at": "2024-12-20T12:29:48.072022Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04392242431640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_usuarios_activos", "compiled": true, "compiled_code": "WITH usuarios_activos AS (\n    SELECT\n        df.month AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fe.user_id) AS usuarios_activos\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_events fe\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    ON\n        fe.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n)\nSELECT * FROM usuarios_activos", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_usuarios_activos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.083262Z", "completed_at": "2024-12-20T12:29:48.117154Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.119707Z", "completed_at": "2024-12-20T12:29:48.119742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.041841745376586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.usuarios_activos", "compiled": true, "compiled_code": "WITH usuarios_activos AS (\n    SELECT\n        df.month AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fe.user_id) AS usuarios_activos\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_events fe\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    ON\n        fe.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n)\nSELECT * FROM usuarios_activos", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.usuarios_activos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.129995Z", "completed_at": "2024-12-20T12:29:48.161913Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.164190Z", "completed_at": "2024-12-20T12:29:48.164224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039351463317871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_recurrencia", "compiled": true, "compiled_code": "WITH usuarios_ordenes AS (\n    SELECT\n        fo.user_id,\n        COUNT(fo.order_id) AS total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders fo\n    GROUP BY\n        fo.user_id\n),\ntasa_recurrencia AS (\n    SELECT\n        COUNT(CASE WHEN total_ordenes > 1 THEN 1 END) * 1.0 / COUNT(*) AS tasa_recurrencia\n    FROM usuarios_ordenes\n)\nSELECT * FROM tasa_recurrencia", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_recurrencia"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.173677Z", "completed_at": "2024-12-20T12:29:48.203261Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.206071Z", "completed_at": "2024-12-20T12:29:48.206113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037056922912597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_recurrencia", "compiled": true, "compiled_code": "WITH usuarios_ordenes AS (\n    SELECT\n        fo.user_id,\n        COUNT(DISTINCT fo.order_id) AS total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    GROUP BY\n        fo.user_id\n),\ntasa_recurrencia AS (\n    SELECT\n        COUNT(CASE WHEN total_ordenes > 1 THEN 1 END) * 1.0 / COUNT(*) AS tasa_recurrencia\n    FROM usuarios_ordenes\n)\nSELECT * FROM tasa_recurrencia", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_recurrencia"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.218052Z", "completed_at": "2024-12-20T12:29:48.250617Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.252983Z", "completed_at": "2024-12-20T12:29:48.253017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040250301361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_avg_revisiones_productos", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\nproducto_calificacion_promedio AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        cp.calificacion_promedio,\n        cp.numero_calificaciones\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON cp.product_id = dp.product_id\n    ORDER BY \n        cp.calificacion_promedio DESC\n)\n\nselect * from producto_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_avg_revisiones_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.271476Z", "completed_at": "2024-12-20T12:29:48.299059Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.301981Z", "completed_at": "2024-12-20T12:29:48.302023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04251837730407715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_categoria_avg_calificaciones", "compiled": true, "compiled_code": "WITH calificaciones_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dr.rating) AS promedio_calificacion,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        dr.product_id = dp.product_id\n    GROUP BY dp.category\n)\nSELECT * FROM calificaciones_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_categoria_avg_calificaciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.313635Z", "completed_at": "2024-12-20T12:29:48.339292Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.342173Z", "completed_at": "2024-12-20T12:29:48.342208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03396320343017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_categoria_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_categoria AS (\n    SELECT\n        dp.category,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY dp.category\n),\ncategoria_max_facturacion AS (\n    SELECT\n        category,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_categoria\n    ORDER BY total_facturado DESC\n)\nSELECT * FROM categoria_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_categoria_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.353038Z", "completed_at": "2024-12-20T12:29:48.385492Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.389251Z", "completed_at": "2024-12-20T12:29:48.389285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04196977615356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_inventario_promedio_categoria", "compiled": true, "compiled_code": "WITH inventario_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dp.inventory) AS inventario_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    GROUP BY\n        dp.category\n)\nSELECT * FROM inventario_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_inventario_promedio_categoria"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.399427Z", "completed_at": "2024-12-20T12:29:48.423642Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.426790Z", "completed_at": "2024-12-20T12:29:48.426836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03243875503540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_producto_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_producto AS (\n    SELECT\n        dp.product_id,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\nproducto_max_facturacion AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_producto\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON facturacion_por_producto.product_id = dp.product_id\n    ORDER BY\n        total_facturado DESC\n)\nSELECT * FROM producto_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_producto_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.438837Z", "completed_at": "2024-12-20T12:29:48.461077Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.463511Z", "completed_at": "2024-12-20T12:29:48.463545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029935598373413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_devoluciones", "compiled": true, "compiled_code": "WITH devoluciones AS (\n    SELECT\n        fo.product_id,\n        COUNT(dr.return_id) as devoluciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_returns dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    ON\n        dr.order_id = fo.order_id\n    GROUP BY\n        fo.product_id\n),\n\ntotal_producto_orders AS (\n    SELECT\n        dp.product_id,\n        COUNT(DISTINCT fo.order_id) as total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\nproducto_tasa_devoluciones AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        devoluciones / total_ordenes as tasa_devoluciones\n    FROM devoluciones\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_products dp\n    ON devoluciones.product_id = dp.product_id\n    JOIN total_producto_orders tpo\n    ON dp.product_id = tpo.product_id\n    ORDER BY\n        tasa_devoluciones DESC\n)\n\nSELECT * FROM producto_tasa_devoluciones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_devoluciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.472882Z", "completed_at": "2024-12-20T12:29:48.502629Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.504922Z", "completed_at": "2024-12-20T12:29:48.504955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03670215606689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.avg_revisiones_productos", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\nproducto_calificacion_promedio AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        cp.calificacion_promedio,\n        cp.numero_calificaciones\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON cp.product_id = dp.product_id\n    ORDER BY \n        cp.calificacion_promedio DESC\n)\n\nselect * from producto_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.avg_revisiones_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.514336Z", "completed_at": "2024-12-20T12:29:48.535751Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.538484Z", "completed_at": "2024-12-20T12:29:48.538517Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02888798713684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.categoria_avg_calificaciones", "compiled": true, "compiled_code": "WITH calificaciones_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dr.rating) AS promedio_calificacion,\n        COUNT(dr.rating) AS numero_calificaciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        dr.product_id = dp.product_id\n    GROUP BY dp.category\n)\nSELECT * FROM calificaciones_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.categoria_avg_calificaciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.549497Z", "completed_at": "2024-12-20T12:29:48.578848Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.581857Z", "completed_at": "2024-12-20T12:29:48.581907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03791928291320801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.categoria_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_categoria AS (\n    SELECT\n        dp.category,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY dp.category\n),\ncategoria_max_facturacion AS (\n    SELECT\n        category,\n        total_facturado,\n        total_vendido\n    FROM facturacion_por_categoria\n    ORDER BY total_facturado DESC\n)\nSELECT * FROM categoria_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.categoria_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.597845Z", "completed_at": "2024-12-20T12:29:48.648168Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.651713Z", "completed_at": "2024-12-20T12:29:48.651758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.062036991119384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.inventario_promedio_categoria", "compiled": true, "compiled_code": "WITH inventario_categoria AS (\n    SELECT\n        dp.category,\n        AVG(dp.inventory) AS inventario_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    GROUP BY\n        dp.category\n)\nSELECT * FROM inventario_categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.inventario_promedio_categoria"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.666156Z", "completed_at": "2024-12-20T12:29:48.695426Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.698347Z", "completed_at": "2024-12-20T12:29:48.698392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03910994529724121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.producto_ventas", "compiled": true, "compiled_code": "WITH facturacion_por_producto AS (\n    SELECT\n        dp.product_id,\n        SUM(dp.precio * fo.quantity) AS total_facturado,\n        SUM(fo.quantity) AS total_vendido\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\nproducto_max_facturacion AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        total_facturado,\n        total_vendido\n        FROM facturacion_por_producto\n        JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n        ON facturacion_por_producto.product_id = dp.product_id\n    ORDER BY\n        total_facturado DESC\n)\nSELECT * FROM producto_max_facturacion", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.producto_ventas"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.713723Z", "completed_at": "2024-12-20T12:29:48.740959Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.743513Z", "completed_at": "2024-12-20T12:29:48.743549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03621172904968262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_devoluciones", "compiled": true, "compiled_code": "WITH devoluciones AS (\n    SELECT\n        dp.product_id,\n        COUNT(dr.return_id) as devoluciones\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_returns dr\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    ON\n        dr.order_id = fo.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\ntotal_producto_orders AS (\n    SELECT\n        dp.product_id,\n        COUNT(fo.order_id) as total_ordenes\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        fo.product_id = dp.product_id\n    GROUP BY\n        dp.product_id\n),\n\nproducto_tasa_devoluciones AS (\n    SELECT\n        dp.product_id,\n        dp.nombre_producto,\n        dp.category,\n        dp.precio,\n        devoluciones / total_ordenes as tasa_devoluciones\n    FROM devoluciones\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON devoluciones.product_id = dp.product_id\n    JOIN total_producto_orders tpo\n    ON dp.product_id = tpo.product_id\n    ORDER BY\n        tasa_devoluciones DESC\n)\n\nSELECT * FROM producto_tasa_devoluciones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_devoluciones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.757238Z", "completed_at": "2024-12-20T12:29:48.821653Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:48.840918Z", "completed_at": "2024-12-20T12:29:48.840963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09123849868774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ventas_estado_categorias", "compiled": true, "compiled_code": "WITH ventas_facturacion_por_estado AS (\n    SELECT\n        dp.category AS categoria,\n        da.state AS estado,\n        da.country AS pais,\n        SUM(fo.quantity) AS total_ventas,\n        SUM(fo.quantity * dp.precio) AS total_facturacion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp ON fo.product_id = dp.product_id\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses da ON fo.address_id = da.address_id\n    GROUP BY\n        dp.category, da.state, da.country\n),\nestado_mas_vendido AS (\n    SELECT\n        categoria,\n        estado AS estado_mas_vendido,\n        pais AS pais_estado_mas_vendido,\n        total_ventas\n    FROM (\n        SELECT\n            categoria,\n            estado,\n            pais,\n            total_ventas,\n            RANK() OVER (PARTITION BY categoria ORDER BY total_ventas DESC,estado ASC) AS rank_ventas\n        FROM ventas_facturacion_por_estado\n    ) ranked_ventas\n    WHERE rank_ventas = 1\n),\nestado_mas_facturado AS (\n    SELECT\n        categoria,\n        estado AS estado_mas_facturado,\n        pais AS pais_estado_mas_facturado,\n        total_facturacion\n    FROM (\n        SELECT\n            categoria,\n            estado,\n            pais,\n            total_facturacion,\n            RANK() OVER (PARTITION BY categoria ORDER BY total_facturacion DESC, estado ASC) AS rank_facturacion\n        FROM ventas_facturacion_por_estado\n    ) ranked_facturacion\n    WHERE rank_facturacion = 1\n)\nSELECT\n    emv.categoria,\n    emv.estado_mas_vendido,\n    emv.pais_estado_mas_vendido,\n    emv.total_ventas AS ventas_estado_mas_vendido,\n    emf.estado_mas_facturado,\n    emf.pais_estado_mas_facturado,\n    emf.total_facturacion AS facturacion_estado_mas_facturado\nFROM\n    estado_mas_vendido emv\nFULL JOIN estado_mas_facturado emf ON emv.categoria = emf.categoria", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ventas_estado_categorias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:48.855159Z", "completed_at": "2024-12-20T12:29:49.126424Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.130078Z", "completed_at": "2024-12-20T12:29:49.130127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28160834312438965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ventas_estado_productos", "compiled": true, "compiled_code": "WITH ventas_facturacion_por_estado AS (\n    SELECT\n        dp.product_id AS producto_id,\n        dp.nombre_producto AS producto,\n        da.state AS estado,\n        da.country AS pais,\n        SUM(fo.quantity) AS total_ventas,\n        SUM(fo.quantity * dp.precio) AS total_facturacion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp ON fo.product_id = dp.product_id\n    INNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_addresses da ON fo.address_id = da.address_id\n    GROUP BY\n        dp.product_id, dp.nombre_producto, da.state, da.country\n),\nestado_mas_vendido AS (\n    SELECT\n        producto_id,\n        producto,\n        estado AS estado_mas_vendido,\n        pais AS pais_estado_mas_vendido,\n        total_ventas\n    FROM (\n        SELECT\n            producto_id,\n            producto,\n            estado,\n            pais,\n            total_ventas,\n            RANK() OVER (PARTITION BY producto_id ORDER BY total_ventas DESC, estado ASC) AS rank_ventas\n        FROM ventas_facturacion_por_estado\n    ) ranked_ventas\n    WHERE rank_ventas = 1\n),\nestado_mas_facturado AS (\n    SELECT\n        producto_id,\n        producto,\n        estado AS estado_mas_facturado,\n        pais AS pais_estado_mas_facturado,\n        total_facturacion\n    FROM (\n        SELECT\n            producto_id,\n            producto,\n            estado,\n            pais,\n            total_facturacion,\n            RANK() OVER (PARTITION BY producto_id ORDER BY total_facturacion DESC, estado ASC) AS rank_facturacion\n        FROM ventas_facturacion_por_estado\n    ) ranked_facturacion\n    WHERE rank_facturacion = 1\n)\nSELECT\n    emv.producto_id AS producto_id,\n    emv.producto AS producto,\n    emv.estado_mas_vendido,\n    emv.pais_estado_mas_vendido,\n    emv.total_ventas AS ventas_estado_mas_vendido,\n    emf.estado_mas_facturado,\n    emf.pais_estado_mas_facturado,\n    emf.total_facturacion AS facturacion_estado_mas_facturado\nFROM\n    estado_mas_vendido emv\nFULL JOIN estado_mas_facturado emf ON emv.producto_id = emf.producto_id", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ventas_estado_productos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.142617Z", "completed_at": "2024-12-20T12:29:49.168312Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.171451Z", "completed_at": "2024-12-20T12:29:49.171489Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034883737564086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_coste_promedio_envio", "compiled": true, "compiled_code": "WITH costo_envio AS (\n    SELECT\n        AVG(do.shipping_cost) AS costo_promedio_envio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM costo_envio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_coste_promedio_envio"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.183047Z", "completed_at": "2024-12-20T12:29:49.221313Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.223666Z", "completed_at": "2024-12-20T12:29:49.223708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04684185981750488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_desempeno_promociones", "compiled": true, "compiled_code": "WITH desempeno_promociones AS (\n    WITH descuentos_unicos AS (\n        SELECT\n            foi.order_id,\n            do.nombre_promocion,\n            do.EUR_discount\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.nombre_promocion, do.EUR_discount\n    )\n\n    SELECT\n        du.nombre_promocion,\n        COUNT(DISTINCT du.order_id) AS numero_ordenes_afectadas,\n        SUM(du.EUR_discount) AS total_descuentos,\n        AVG(do.order_total) AS gasto_promedio_por_orden\n    FROM\n        descuentos_unicos du\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        du.order_id = do.order_id\n    GROUP BY\n        du.nombre_promocion\n)\n\nSELECT * FROM desempeno_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_desempeno_promociones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.235868Z", "completed_at": "2024-12-20T12:29:49.259121Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.262077Z", "completed_at": "2024-12-20T12:29:49.262111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03177285194396973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_eficiencia_envios", "compiled": true, "compiled_code": "WITH shipping_efficiency AS (\n    WITH unique_shipping_costs AS (\n        SELECT\n            foi.order_id,\n            do.shipping_service,\n            do.shipping_cost\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.shipping_service, do.shipping_cost\n    )\n    SELECT\n        usc.shipping_service,\n        COUNT(DISTINCT usc.order_id) AS total_envios,\n        SUM(usc.shipping_cost) AS costo_envio_total,\n        AVG(usc.shipping_cost) AS costo_envio_promedio,\n        AVG(DATEDIFF(DAY, do.created_at, do.delivered_at)) AS promedio_tiempo_entrega\n    FROM\n        unique_shipping_costs usc\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        usc.order_id = do.order_id\n    GROUP BY\n        usc.shipping_service\n    ORDER BY costo_envio_total DESC\n)\nSELECT * FROM shipping_efficiency", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_eficiencia_envios"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.272191Z", "completed_at": "2024-12-20T12:29:49.294443Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.297252Z", "completed_at": "2024-12-20T12:29:49.297285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03005695343017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_entregas_a_tiempo", "compiled": true, "compiled_code": "WITH entregas_tiempo AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at <= do.estimated_delivery_at THEN 1 END) * 1.0 / COUNT(*) AS tasa_entregas_tiempo\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM entregas_tiempo", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_entregas_a_tiempo"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.306763Z", "completed_at": "2024-12-20T12:29:49.327429Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.330028Z", "completed_at": "2024-12-20T12:29:49.330066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02789926528930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_ordenes_ventas_mes", "compiled": true, "compiled_code": "WITH ordenes_ventas_agrupadas AS (\n    SELECT\n        TO_CHAR(DATE_FROM_PARTS(df.year, df.month, 1), 'Month') AS mes,\n        df.year AS anyo,\n        COUNT(fo.order_id) AS total_ordenes,\n        SUM(do.order_total) AS valor_total_ventas\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        fo.order_id = do.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    ON\n        do.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n    ORDER BY\n        total_ordenes DESC\n)\nSELECT * FROM ordenes_ventas_agrupadas", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_ordenes_ventas_mes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.340859Z", "completed_at": "2024-12-20T12:29:49.360668Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.363925Z", "completed_at": "2024-12-20T12:29:49.363959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028408527374267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_porcentaje_entregas_tardias", "compiled": true, "compiled_code": "WITH entregas_tardias AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at > do.estimated_delivery_at THEN 1 END) * 1.0 /\n        COUNT(*) * 100 AS porcentaje_entregas_tardias\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n)\nSELECT * FROM entregas_tardias", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_porcentaje_entregas_tardias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.375131Z", "completed_at": "2024-12-20T12:29:49.407491Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.410041Z", "completed_at": "2024-12-20T12:29:49.410085Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04103994369506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tasa_ordenes_con_promos", "compiled": true, "compiled_code": "WITH ordenes_promociones AS (\n    SELECT\n        COUNT(CASE WHEN do.EUR_discount > 0 THEN 1 END) * 1.0 / COUNT(*) AS tasa_ordenes_promocion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n)\nSELECT * FROM ordenes_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tasa_ordenes_con_promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.420923Z", "completed_at": "2024-12-20T12:29:49.444029Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.446492Z", "completed_at": "2024-12-20T12:29:49.446526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030254364013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tiempo_avanzado", "compiled": true, "compiled_code": "WITH ventas_por_tiempo AS (\n    SELECT\n        df.month AS mes,\n        df.quarter AS trimestre,\n        df.date_day,\n        do.order_total\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_fecha df\n    LEFT JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    ON\n        df.date_day = do.created_at\n),\nventas_agregadas AS (\n    SELECT\n        mes,\n        trimestre,\n        COALESCE(SUM(order_total),0) AS ventas_totales_mes,\n        COALESCE(SUM(SUM(order_total)) OVER (PARTITION BY trimestre),0) AS ventas_totales_trimestre\n    FROM\n        ventas_por_tiempo\n    GROUP BY\n        mes, trimestre\n)\n\nSELECT\n    TO_CHAR(DATE_FROM_PARTS(1, mes, 1), 'Month') AS Meses,\n    trimestre,\n    ventas_totales_mes,\n    ventas_totales_trimestre,\n    COALESCE(ventas_totales_mes - LAG(ventas_totales_mes) OVER (ORDER BY mes), 0) AS variacion_mensual,\n    COALESCE(ventas_totales_trimestre - LAG(ventas_totales_trimestre) OVER (ORDER BY trimestre), 0) AS variacion_trimestral\nFROM\n    ventas_agregadas\nORDER BY\n    mes", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tiempo_avanzado"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.457174Z", "completed_at": "2024-12-20T12:29:49.476596Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.478936Z", "completed_at": "2024-12-20T12:29:49.478981Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027925968170166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_tiempo_promedio_entrega", "compiled": true, "compiled_code": "WITH tiempo_entrega AS (\n    SELECT\n        DATEDIFF(day, do.created_at, do.delivered_at) AS dias_entrega\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n),\npromedio_entrega AS (\n    SELECT\n        AVG(dias_entrega) AS tiempo_promedio_entrega\n    FROM tiempo_entrega\n)\nSELECT * FROM promedio_entrega", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_tiempo_promedio_entrega"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.490246Z", "completed_at": "2024-12-20T12:29:49.515945Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.518614Z", "completed_at": "2024-12-20T12:29:49.518663Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033574581146240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.coste_promedio_envio", "compiled": true, "compiled_code": "WITH costo_envio AS (\n    SELECT\n        AVG(do.shipping_cost) AS costo_promedio_envio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM costo_envio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.coste_promedio_envio"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.531175Z", "completed_at": "2024-12-20T12:29:49.562732Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.565556Z", "completed_at": "2024-12-20T12:29:49.565589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04053640365600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.desempeno_promociones", "compiled": true, "compiled_code": "WITH desempeno_promociones AS (\n    WITH descuentos_unicos AS (\n        SELECT\n            foi.order_id,\n            do.nombre_promocion,\n            do.EUR_discount\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.nombre_promocion, do.EUR_discount\n    )\n\n    SELECT\n        du.nombre_promocion,\n        COUNT(DISTINCT du.order_id) AS numero_ordenes_afectadas,\n        SUM(du.EUR_discount) AS total_descuentos,\n        AVG(do.order_total) AS gasto_promedio_por_orden\n    FROM\n        descuentos_unicos du\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        du.order_id = do.order_id\n    GROUP BY\n        du.nombre_promocion\n)\n\nSELECT * FROM desempeno_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.desempeno_promociones"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.575442Z", "completed_at": "2024-12-20T12:29:49.600023Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.602828Z", "completed_at": "2024-12-20T12:29:49.602871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03222990036010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.eficiencia_envios", "compiled": true, "compiled_code": "WITH shipping_efficiency AS (\n    WITH unique_shipping_costs AS (\n        SELECT\n            foi.order_id,\n            do.shipping_service,\n            do.shipping_cost\n        FROM\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders foi\n        JOIN\n            ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n        ON\n            foi.order_id = do.order_id\n        GROUP BY\n            foi.order_id, do.shipping_service, do.shipping_cost\n    )\n    SELECT\n        usc.shipping_service,\n        COUNT(DISTINCT usc.order_id) AS total_envios,\n        SUM(usc.shipping_cost) AS costo_envio_total,\n        AVG(usc.shipping_cost) AS costo_envio_promedio,\n        AVG(DATEDIFF(DAY, do.created_at, do.delivered_at)) AS promedio_tiempo_entrega\n    FROM\n        unique_shipping_costs usc\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        usc.order_id = do.order_id\n    GROUP BY\n        usc.shipping_service\n    ORDER BY costo_envio_total DESC\n)\nSELECT * FROM shipping_efficiency", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.eficiencia_envios"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.613536Z", "completed_at": "2024-12-20T12:29:49.636432Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.639816Z", "completed_at": "2024-12-20T12:29:49.639865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03189873695373535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.entregas_a_tiempo", "compiled": true, "compiled_code": "WITH entregas_tiempo AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at <= do.estimated_delivery_at THEN 1 END) * 1.0 / COUNT(*) AS tasa_entregas_tiempo\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM entregas_tiempo", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.entregas_a_tiempo"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.666333Z", "completed_at": "2024-12-20T12:29:49.726133Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.730385Z", "completed_at": "2024-12-20T12:29:49.730434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0738062858581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.ordenes_ventas_mes", "compiled": true, "compiled_code": "WITH ordenes_ventas_agrupadas AS (\n    SELECT\n        TO_CHAR(DATE_FROM_PARTS(df.year, df.month, 1), 'Month') AS mes,\n        df.year AS anyo,\n        COUNT(DISTINCT fo.order_id) AS total_ordenes,\n        SUM(do.order_total) AS valor_total_ventas\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders fo\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        fo.order_id = do.order_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    ON\n        do.created_at = df.date_day\n    GROUP BY\n        df.month, df.year\n    ORDER BY\n        total_ordenes DESC\n)\nSELECT * FROM ordenes_ventas_agrupadas", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.ordenes_ventas_mes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.748059Z", "completed_at": "2024-12-20T12:29:49.779001Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.782159Z", "completed_at": "2024-12-20T12:29:49.782207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04155850410461426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.porcentaje_entregas_tardias", "compiled": true, "compiled_code": "WITH entregas_tardias AS (\n    SELECT\n        COUNT(CASE WHEN do.delivered_at > do.estimated_delivery_at THEN 1 END) * 1.0 /\n        COUNT(*) * 100 AS porcentaje_entregas_tardias\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n)\nSELECT * FROM entregas_tardias", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.porcentaje_entregas_tardias"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.804360Z", "completed_at": "2024-12-20T12:29:49.838351Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.841354Z", "completed_at": "2024-12-20T12:29:49.841397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05023908615112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tasa_ordenes_con_promos", "compiled": true, "compiled_code": "WITH ordenes_promociones AS (\n    SELECT\n        COUNT(CASE WHEN do.EUR_discount > 0 THEN 1 END) * 1.0 / COUNT(*) AS tasa_ordenes_promocion\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n)\nSELECT * FROM ordenes_promociones", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tasa_ordenes_con_promos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.851708Z", "completed_at": "2024-12-20T12:29:49.877258Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.880242Z", "completed_at": "2024-12-20T12:29:49.880285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03374004364013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tiempo_avanzado", "compiled": true, "compiled_code": "WITH ventas_por_tiempo AS (\n    SELECT\n        df.month AS mes,\n        df.quarter AS trimestre,\n        df.date_day,\n        do.order_total\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_fecha df\n    LEFT JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    ON\n        df.date_day = do.created_at\n),\nventas_agregadas AS (\n    SELECT\n        mes,\n        trimestre,\n        COALESCE(SUM(order_total),0) AS ventas_totales_mes,\n        COALESCE(SUM(SUM(order_total)) OVER (PARTITION BY trimestre),0) AS ventas_totales_trimestre\n    FROM\n        ventas_por_tiempo\n    GROUP BY\n        mes, trimestre\n)\n\nSELECT\n    TO_CHAR(DATE_FROM_PARTS(1, mes, 1), 'Month') AS Meses,\n    trimestre,\n    ventas_totales_mes,\n    ventas_totales_trimestre,\n    COALESCE(ventas_totales_mes - LAG(ventas_totales_mes) OVER (ORDER BY mes), 0) AS variacion_mensual,\n    COALESCE(ventas_totales_trimestre - LAG(ventas_totales_trimestre) OVER (ORDER BY trimestre), 0) AS variacion_trimestral\nFROM\n    ventas_agregadas\nORDER BY\n    mes", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tiempo_avanzado"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.891887Z", "completed_at": "2024-12-20T12:29:49.919044Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.922229Z", "completed_at": "2024-12-20T12:29:49.922272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036133527755737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.tiempo_promedio_entrega", "compiled": true, "compiled_code": "WITH tiempo_entrega AS (\n    SELECT\n        DATEDIFF(day, do.created_at, do.delivered_at) AS dias_entrega\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders do\n    WHERE\n        do.delivered_at IS NOT NULL\n),\npromedio_entrega AS (\n    SELECT\n        AVG(dias_entrega) AS tiempo_promedio_entrega\n    FROM tiempo_entrega\n)\nSELECT * FROM promedio_entrega", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.tiempo_promedio_entrega"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.933525Z", "completed_at": "2024-12-20T12:29:49.959904Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.963651Z", "completed_at": "2024-12-20T12:29:49.963696Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035974979400634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_avg_revisiones_usuario", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.user_id,\n        AVG(dr.rating) AS calificacion_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_reviews dr\n    GROUP BY\n        dr.user_id\n),\nusuario_calificacion_promedio AS (\n    SELECT\n        du.user_id,\n        du.first_name,\n        du.last_name,\n        du.email,\n        cp.calificacion_promedio\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users du\n    ON cp.user_id = du.user_id\n)\n\nselect * from usuario_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_avg_revisiones_usuario"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:49.976264Z", "completed_at": "2024-12-20T12:29:49.996947Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:49.999408Z", "completed_at": "2024-12-20T12:29:49.999441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0283815860748291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.H3_users_info", "compiled": true, "compiled_code": "WITH user_data AS (\n    SELECT \n        u.user_id,\n        u.first_name,\n        u.last_name,\n        u.email,\n        COUNT(DISTINCT o.order_id) AS total_orders,\n        SUM(d.order_total) AS total_spent, -- Ajustado a `dim_orders.order_total`\n        COALESCE(SUM(d.shipping_cost), 0) AS total_shipping_cost, -- Ajustado a `dim_orders.shipping_cost`\n        COALESCE(SUM(d.EUR_discount), 0) AS total_discount,\n        COALESCE(SUM(foi.quantity), 0) AS total_products_bought,\n        COUNT(DISTINCT foi.product_id) AS total_unique_products_bought\n    FROM \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_users u\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_orders o ON u.user_id = o.user_id\n    LEFT JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_facts_order_items foi ON foi.order_id = o.order_id\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_dim_orders d ON o.order_id = d.order_id -- Agregado para usar columnas de `dim_orders`\n    GROUP BY \n        u.user_id, u.first_name, u.last_name, u.email\n    ORDER BY total_orders DESC\n\n)\n\nSELECT * \nFROM user_data", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_3_hechos.H3_users_info"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.008092Z", "completed_at": "2024-12-20T12:29:50.036340Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.039084Z", "completed_at": "2024-12-20T12:29:50.039119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03535342216491699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.avg_revisiones_usuario", "compiled": true, "compiled_code": "WITH calificacion_promedio AS (\n    SELECT\n        dr.user_id,\n        AVG(dr.rating) AS calificacion_promedio\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.user_id\n),\nusuario_calificacion_promedio AS (\n    SELECT\n        du.user_id,\n        du.first_name,\n        du.last_name,\n        du.email,\n        cp.calificacion_promedio\n    FROM calificacion_promedio cp\n    JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users du\n    ON cp.user_id = du.user_id\n)\n\nselect * from usuario_calificacion_promedio", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.avg_revisiones_usuario"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.050301Z", "completed_at": "2024-12-20T12:29:50.075407Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.078102Z", "completed_at": "2024-12-20T12:29:50.078149Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03376913070678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.users_info", "compiled": true, "compiled_code": "WITH user_data AS (\n    SELECT \n        u.user_id,\n        u.first_name,\n        u.last_name,\n        u.email,\n        COUNT(DISTINCT o.order_id) AS total_orders,\n        SUM(d.order_total) AS total_spent, -- Ajustado a `dim_orders.order_total`\n        COALESCE(SUM(d.shipping_cost), 0) AS total_shipping_cost, -- Ajustado a `dim_orders.shipping_cost`\n        COALESCE(SUM(d.EUR_discount), 0) AS total_discount,\n        COALESCE(SUM(o.quantity), 0) AS total_products_bought,\n        COUNT(DISTINCT o.product_id) AS total_unique_products_bought\n    FROM \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_users u\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.facts_orders o ON u.user_id = o.user_id\n    LEFT JOIN \n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_orders d ON o.order_id = d.order_id -- Agregado para usar columnas de `dim_orders`\n    GROUP BY \n        u.user_id, u.first_name, u.last_name, u.email\n    ORDER BY total_orders DESC\n)\n\nSELECT * \nFROM user_data", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.users_info"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.091611Z", "completed_at": "2024-12-20T12:29:50.118321Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.121016Z", "completed_at": "2024-12-20T12:29:50.121051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0359041690826416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.product_snap", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap)\n    \n),\nrenamed as (\n    select\n        product_id,\n        precio,\n        nombre_producto,\n        category,\n        inventory,\n        p.llegada_id\n    from source p\n    join ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo__category c \n        on p.category_id = c.category_id\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.135926Z", "completed_at": "2024-12-20T12:29:50.169294Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.172291Z", "completed_at": "2024-12-20T12:29:50.172340Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044976234436035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo_snap_product_inventory__0.c980f0342e", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and inventory >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.185617Z", "completed_at": "2024-12-20T12:29:50.222409Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.224883Z", "completed_at": "2024-12-20T12:29:50.224917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.045029401779174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_sql_server_dbo_snap_product_precio__0.3500d1066e", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and precio >= 0\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.233850Z", "completed_at": "2024-12-20T12:29:50.255757Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.257987Z", "completed_at": "2024-12-20T12:29:50.258024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028661012649536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_sql_server_dbo_snap_product_product_id.c9eef4dcab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.267828Z", "completed_at": "2024-12-20T12:29:50.293355Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.296189Z", "completed_at": "2024-12-20T12:29:50.296223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03329157829284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.unique_stg_sql_server_dbo_snap_product_product_id.882da776c3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_sql_server_dbo_snap_product\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.306490Z", "completed_at": "2024-12-20T12:29:50.327255Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.329733Z", "completed_at": "2024-12-20T12:29:50.329776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02842426300048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.review_snap", "compiled": true, "compiled_code": "\n\nwith \n\nsource as (\n    select * from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n        where llegada_id > (select max(llegada_id) from ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap)\n    \n),\n\nrenamed as (\n    select\n        review_id,\n        user_id,\n        product_id,\n        rating,\n        comments,\n        created_at,\n        llegada_id\n    from source\n)\n\nselect * from renamed", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.341240Z", "completed_at": "2024-12-20T12:29:50.367773Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.370126Z", "completed_at": "2024-12-20T12:29:50.370178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034596920013427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_value_lengths_to_be_between_stg_google_sheets__snap_reviews_comments__1000__0.9968e5e7b1", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and length(\n        comments\n    ) >= 0 and length(\n        comments\n    ) <= 1000\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.379802Z", "completed_at": "2024-12-20T12:29:50.414663Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:50.417452Z", "completed_at": "2024-12-20T12:29:50.417498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04291796684265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_between_stg_google_sheets__snap_reviews_rating__5__1.ef5838a5f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rating >= 1 and rating <= 5\n)\n as expression\n\n\n    from ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:50.430178Z", "completed_at": "2024-12-20T12:29:51.036158Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:51.039109Z", "completed_at": "2024-12-20T12:29:51.039144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.726165771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.dbt_expectations_expect_column_values_to_be_of_type_stg_google_sheets__snap_reviews_created_at__date.5bcf8f6bcc", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('REVIEW_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('USER_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('PRODUCT_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('RATING' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('COMMENTS' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('CREATED_AT' as TEXT) as relation_column,\n            cast('DATE' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('LLEGADA_ID' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'CREATED_AT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:51.160917Z", "completed_at": "2024-12-20T12:29:51.192088Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:51.194321Z", "completed_at": "2024-12-20T12:29:51.194373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03899979591369629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Proyecto_final.not_null_stg_google_sheets__snap_reviews_rating.00ed0522b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom ALUMNO11_PRO_SILVER_DB.ALUMNO11_staging.stg_google_sheets__snap_reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:51.209175Z", "completed_at": "2024-12-20T12:29:51.236796Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:51.239433Z", "completed_at": "2024-12-20T12:29:51.239482Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038434505462646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.precio_historico", "compiled": true, "compiled_code": "WITH product_history AS (\n\nSELECT\n    ps.product_id,\n    ps.nombre_producto,\n    ps.precio as precio_original,\n    dp.precio as precio_actual,\n    ABS(precio_original - precio_actual) AS price_difference\nFROM ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\nINNER JOIN ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.product_snap ps \nON dp.product_id = ps.product_id\nWHERE price_difference > 0\nORDER BY price_difference DESC\n\n)\n\nselect * from product_history", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.precio_historico"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-20T12:29:51.250923Z", "completed_at": "2024-12-20T12:29:51.278051Z"}, {"name": "execute", "started_at": "2024-12-20T12:29:51.280504Z", "completed_at": "2024-12-20T12:29:51.280538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035195350646972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Proyecto_final.rating_historico", "compiled": true, "compiled_code": "WITH reviews_snapshot AS (\n    SELECT\n        rs.review_id,\n        rs.product_id,\n        rs.rating AS rating_snapshot,\n        rs.comments AS comments_snapshot\n    FROM ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.review_snap rs\n),\n\ncalificacion_promedio_actual AS (\n    SELECT\n        dr.product_id,\n        AVG(dr.rating) AS calificacion_promedio_actual,\n        COUNT(dr.rating) AS numero_calificaciones_actuales\n    FROM\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_reviews dr\n    GROUP BY\n        dr.product_id\n),\n\ncalificacion_promedio_historica AS (\n    SELECT\n        rs.product_id,\n        AVG(rs.rating_snapshot) AS calificacion_promedio_historica,\n        COUNT(rs.rating_snapshot) AS numero_calificaciones_historicas\n    FROM\n        reviews_snapshot rs\n    GROUP BY\n        rs.product_id\n),\n\ncomparacion_reviews AS (\n    SELECT\n        ca.product_id,\n        dp.nombre_producto,\n        dp.category,\n        ca.calificacion_promedio_actual,\n        ca.numero_calificaciones_actuales,\n        ch.calificacion_promedio_historica,\n        ch.numero_calificaciones_historicas,\n        ABS(ca.calificacion_promedio_actual - ch.calificacion_promedio_historica) AS diferencia_calificacion_promedio,\n        ca.numero_calificaciones_actuales - ch.numero_calificaciones_historicas AS diferencia_numero_calificaciones\n    FROM\n        calificacion_promedio_actual ca\n    LEFT JOIN\n        calificacion_promedio_historica ch\n    ON\n        ca.product_id = ch.product_id\n    JOIN\n        ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.dim_products dp\n    ON\n        ca.product_id = dp.product_id\n)\n\nSELECT\n    *\nFROM\n    comparacion_reviews\nWHERE diferencia_calificacion_promedio > 0\nORDER BY\n    diferencia_calificacion_promedio DESC", "relation_name": "ALUMNO11_PRO_GOLD_DB.ALUMNO11_Marts_2_hechos.rating_historico"}], "elapsed_time": 14.850613594055176, "args": {"warn_error_options": {"include": [], "exclude": []}, "which": "generate", "require_resource_names_without_spaces": false, "use_colors": true, "favor_state": false, "profiles_dir": "/home/juanma/.dbt", "select": [], "populate_cache": true, "partial_parse_file_diff": true, "strict_mode": false, "quiet": false, "log_format_file": "debug", "send_anonymous_usage_stats": true, "log_level": "info", "write_json": true, "partial_parse": true, "source_freshness_run_project_hooks": false, "exclude": [], "compile": true, "log_path": "/mnt/c/Users/juanm/Desktop/DBT/curso_data_engineering/logs", "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "static": false, "indirect_selection": "eager", "enable_legacy_logger": false, "version_check": true, "log_format": "default", "use_colors_file": true, "vars": {}, "project_dir": "/mnt/c/Users/juanm/Desktop/DBT/curso_data_engineering", "log_file_max_bytes": 10485760, "defer": false, "introspect": true, "invocation_command": "dbt docs generate", "macro_debugging": false, "printer_width": 80, "log_level_file": "debug", "static_parser": true, "cache_selected_only": false, "empty_catalog": false}}